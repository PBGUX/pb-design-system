!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@ng-bootstrap/ng-bootstrap"),require("d3-selection"),require("d3-scale"),require("d3-shape"),require("d3-interpolate"),require("d3-format"),require("d3-time-format"),require("d3"),require("d3-array"),require("d3-axis"),require("d3-ease"),require("d3-geo"),require("topojson-client"),require("d3-collection"),require("@angular/forms"),require("@angular/material/radio")):"function"==typeof define&&define.amd?define("pb-design-system",["exports","@angular/core","@angular/common","@ng-bootstrap/ng-bootstrap","d3-selection","d3-scale","d3-shape","d3-interpolate","d3-format","d3-time-format","d3","d3-array","d3-axis","d3-ease","d3-geo","topojson-client","d3-collection","@angular/forms","@angular/material/radio"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["pb-design-system"]={},t.ng.core,t.ng.common,t["^7"][0][0],t["d3-selection"],t["d3-scale"],t["d3-shape"],t["d3-interpolate"],t["d3-format"],t["d3-time-format"],t["^5"][16][0],t["d3-array"],t["d3-axis"],t["d3-ease"],t["d3-geo"],t["^3"][0][0],t["d3-collection"],t.ng.forms,t.ng.material.radio)}(this,(function(t,e,i,a,n,s,r,o,l,h,c,d,u,p,g,m,f,x,y){"use strict";var v=function(){function t(){var t=this;this.colors={classic:{full:["#B70077","#0384D4","#EE6B0B","#A319B1","#11A611","#1BB9FF","#495A9C","#EDB700","#8B98C8","#E6C49C","#CCB8CE","#9B9B9B"],mono:["#001D56","#003296","#4B74C5","#89A1D0","#A3BCEE","#C9D7F3"]},twilight:{full:["#A319B1","#11A611","#1BB9FF","#EE6B0B","#B70077","#0384D4","#495A9C","#EDB700","#8B98C8","#E6C49C","#CCB8CE","#9B9B9B"],mono:["#05395C","#0A5B92","#0072B8","#5DA9DC","#A5D4F3","#D1EDFF"]},ocean:{full:["#0384D4","#B70077","#1BB9FF","#495A9C","#EDB700","#A319B1","#EE6B0B","#11A611","#8B98C8","#E6C49C","#CCB8CE","#9B9B9B"],mono:["#394B4D","#3A6B6E","#14767D","#99BFC2","#C9E6E8","#DEECED"]},sunset:{full:["#B70077","#EE6B0B","#1BB9FF","#EDB700","#11A611","#A319B1","#0384D4","#CCB8CE","#495A9C","#E6C49C","#8B98C8","#9B9B9B"],mono:["#31254A","#50248F","#7945C4","#9A79E2","#C4A8FF","#D9C7FF"]}},this.getColors=function(e,i){return void 0===e&&(e=!1),void 0===i&&(i="classic"),e?t.colors[i].mono:t.colors[i].full},this.createGradientDefs=function(e,i,a,n){void 0===i&&(i=!1),void 0===a&&(a="classic"),void 0===n&&(n=!0);for(var s=i?[t.colors[a].mono[2]]:t.colors[a].full,r=0;r<s.length;r++){var o=i?t.colors[a].mono[2]:t.colors[a].full[r],l=void 0;n?((l=e.append("defs").append("linearGradient").attr("id","gradient-"+o.replace("#","")).attr("x1","0").attr("y1","0").attr("x2","0").attr("y2","1").attr("spreadMethod","pad")).append("stop").attr("offset","0%").attr("stop-color",o).attr("stop-opacity","1"),l.append("stop").attr("offset","100%").attr("stop-color",o).attr("stop-opacity",".3")):((l=e.append("defs").append("linearGradient").attr("id","gradient-horizontal-"+o.replace("#","")).attr("x1","1").attr("y1","0").attr("x2","0").attr("y2","0").attr("spreadMethod","pad")).append("stop").attr("offset","0%").attr("stop-color",o).attr("stop-opacity","1"),l.append("stop").attr("offset","100%").attr("stop-color",o).attr("stop-opacity",".3"))}return s},this.createGlowFilter=function(t){var e=t.append("defs").append("filter").attr("id","glow").attr("width","200%").attr("height","200%");e.append("feGaussianBlur").attr("in","SourceGraphic").attr("stdDeviation",4);for(var i=[{dy:2,slope:.2},{dy:5,slope:.05}],a=0;a<i.length;a++)e.append("feOffset").attr("result","offsetBlur"+a).attr("dx",0).attr("dy",i[a].dy);for(var n=0;n<i.length;n++)e.append("feComponentTransfer").attr("result","coloredBlur"+n).attr("in","offsetBlur"+n).append("feFuncA").attr("type","linear").attr("slope",i[n].slope);var s=e.append("feMerge");s.append("feMergeNode").attr("in","SourceGraphic");for(var r=0;r<i.length;r++)s.append("feMergeNode").attr("in","coloredBlur"+r)}}return t.prototype.d3Format=function(t,e){var i;switch(t){case"number":i=c.format(e);break;case"time":i=c.timeFormat(e);break;default:i=null}return i},t}();v.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new v},token:v,providedIn:"root"}),v.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],v.ctorParameters=function(){return[]};var b=function(){function t(t,i){var a=this;this._dataviz=t,this._element=i,this.chartClass=!0,this.pieClass=!0,this.width=300,this.type="pie",this.monochrome=!1,this.legendLabelFormatType=null,this.legendLabelFormatString="",this.legendValueFormatString="",this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipValueFormatString="",this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.currentData=[],this.updateChart=function(t){void 0===t&&(t=!0),a.svg.selectAll("path").data(a.pie(a.data)).join((function(e){var i=e.append("path");return i.each((function(t){return t.outerRadius=a.outerRadius})).attr("fill",(function(t){return a.colorRange(t.data.label)})).attr("class","slice").each((function(t,e,i){a.currentData.splice(e,1,t)})),"pie"===a.type&&i.style("stroke","#fff").style("stroke-width",2).style("stroke-alignment","inner"),i.call((function(e){return e.transition().duration((function(e,i,a){return t?0:500})).attrTween("d",a.arcEnterTween)})),i}),(function(t){return a.tooltipHide(),t.each((function(t){return t.outerRadius=a.outerRadius})).call((function(t){return t.transition().duration(500).attrTween("d",a.arcTween)})),t}),(function(t){return t.remove()})).on("mouseover",(function(t,e,i){a.pathMouseOver(n.event,t,e,i)})).on("mousemove",(function(t,e,i){a.tooltipShow(a.chart.node(),t),a.tooltipMove(a.chart.node())})).on("mouseout",(function(t,e,i){a.pathMouseOut(t,e,i),a.tooltipHide()})).on("click",(function(t,e,i){a.pathClick(n.event,t,e,i)})),a.chart.select(".legend").selectAll(".legend-item").data(a.data).join((function(t){var e=t.append("li").attr("class","legend-item");e.append("span").attr("class","legend-key").style("background-color",(function(t){return a.colorRange(t.label)}));var i=e.append("span").attr("class","legend-description");return i.append("span").attr("class","legend-label").html((function(t){switch(a.legendLabelFormatType){case"time":var e=h.isoParse(t.label);return a.legendLabelFormat(e);default:return t.label}})),i.append("span").attr("class","legend-value").html((function(t){return a.legendValueFormat(t.value)})),e}),(function(t){return t.selectAll(".legend-key").style("background-color",(function(t){return a.colorRange(t.label)})),t.select(".legend-label").html((function(t){switch(a.legendLabelFormatType){case"time":var e=h.isoParse(t.label);return a.legendLabelFormat(e);default:return t.label}})),t.select(".legend-value").html((function(t){return a.legendValueFormat(t.value)})),t}),(function(t){return t.remove()})).on("mouseover focus",(function(t,e,i){a.legendMouseOverFocus(t,e,i),a.pathMouseOver(n.event,t,e,i)})).on("mouseout blur",(function(t,e,i){a.legendMouseOutBlur(t,e,i),a.pathMouseOut(t,e,i)})).on("click",(function(t,e,i){a.clicked.emit({event:n.event,data:t})}))},this.arcEnterTween=function(t,e,i){var n=o.interpolate(t.startAngle,t.endAngle);return function(e){return t.endAngle=n(e),a.arc(t)}},this.arcTween=function(t,e,i){var n=o.interpolate(a.currentData[e],t);return a.currentData[e]=n(1),function(t){return a.arc(n(t))}},this.arcExitTween=function(t,e,i){var n=Object.assign({},a.currentData[e],{startAngle:a.currentData[e].endAngle}),s=o.interpolate(t,n);return function(t){return a.arc(s(t))}},this.arcMouseOverTween=function(t,e,i){var n=o.interpolate(t.outerRadius,a.outerRadius+a.arcZoom);return function(e){return t.outerRadius=n(e),a.arc(t)}},this.arcMouseOutTween=function(t,e,i){var n=o.interpolate(t.outerRadius,a.outerRadius);return function(e){return t.outerRadius=n(e),a.arc(t)}},this.legendMouseOverFocus=function(t,e,i){a.chart.selectAll(".legend-item").filter((function(t,i){return i!==e})).classed("inactive",!0)},this.legendMouseOutBlur=function(t,e,i){a.chart.selectAll(".legend-item").classed("inactive",!1)},this.pathMouseOver=function(t,e,i,n){var s=a.chart.selectAll(".slice"),r=s.filter((function(t,e){return e===i}));a.chart.selectAll(".legend-item").filter((function(t,e){return e!==i})).classed("inactive",!0),s.filter((function(t,e){return e!==i})).classed("inactive",!0),r.transition().duration(300).delay(0).attrTween("d",a.arcMouseOverTween),a.hovered.emit({event:t,data:e.data?e.data:e})},this.pathMouseOut=function(t,e,i){var n=a.chart.selectAll(".slice"),s=n.filter((function(t,i){return i===e}));a.chart.selectAll(".legend-item").filter((function(t,i){return i!==e})).classed("inactive",!1),n.classed("inactive",!1),s.transition().duration(300).delay(0).attrTween("d",a.arcMouseOutTween)},this.pathClick=function(t,e,i,n){a.clicked.emit({event:t,data:e.data})},this.tooltipShow=function(t,e){a.tooltipSetPosition(t);var i,n=(e.endAngle-e.startAngle)/(2*Math.PI);switch(a.tooltipLabelFormatType){case"time":var s=h.isoParse(e.data.label);i=a.tooltipLabelFormat(s);break;default:i=e.data.label}a.tooltip.html('\n        <div class="tooltip-label">'+i+'</div>\n        <div class="tooltip-value">'+a.tooltipValueFormat(n)+"</div>\n      "),a.tooltip.style("opacity",1)},this.tooltipMove=function(t){a.tooltipSetPosition(t)},this.tooltipHide=function(){a.tooltip.style("opacity",0)},this.tooltipSetPosition=function(t){var e=n.mouse(t);a.tooltip.style("left",e[0]+16+"px"),a.tooltip.style("top",e[1]+16+"px")}}return t.prototype.ngOnInit=function(){this.margin={top:10,right:10,bottom:10,left:10},this.width=this.width-this.margin.left-this.margin.right,this.height=this.width-this.margin.top-this.margin.bottom,this.colors=this._dataviz.getColors(this.monochrome,this.theme),this.innerRadius=Math.min(this.width,this.height)/2.5,this.outerRadius=Math.min(this.width,this.height)/2,this.arcZoom=10,this.anglePad=.02,this.legendValueFormat=l.format(this.legendValueFormatString),this.tooltipValueFormat=l.format(this.tooltipValueFormatString),this.legendLabelFormat=this._dataviz.d3Format(this.legendLabelFormatType,this.legendLabelFormatString),this.tooltipLabelFormat=this._dataviz.d3Format(this.tooltipLabelFormatType,this.tooltipLabelFormatString),this.colorRange=s.scaleOrdinal().range(this.colors).domain(this.data.map((function(t){return t.label}))),"pie"===this.type&&(this.innerRadius=0,this.anglePad=0),this.pie=r.pie().padAngle(this.anglePad).value((function(t){return t.value})).sort(null),this.arc=r.arc().padRadius(this.outerRadius).innerRadius(this.innerRadius),this.chart=n.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",this.width).attr("height",this.height).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+(this.width/2+this.margin.left)+" -"+(this.height/2+this.margin.top)+" "+(this.width+this.margin.left+this.margin.right)+" "+(this.height+this.margin.top+this.margin.bottom)),this.chart.append("ul").attr("class","legend legend-right"),this.tooltip=this.chart.append("div").style("opacity",0).attr("class","pbds-tooltip").attr("aria-hidden","true"),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart(!1)},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t}();b.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-pie",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],b.ctorParameters=function(){return[{type:v},{type:e.ElementRef}]},b.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],pieClass:[{type:e.HostBinding,args:["class.pbds-chart-pie"]}],data:[{type:e.Input}],width:[{type:e.Input}],type:[{type:e.Input}],monochrome:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],legendValueFormatString:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]};var A=function(){function t(t,i,a,s){var r=this;this._dataviz=t,this._element=i,this._scroll=a,this._location=s,this.chartClass=!0,this.barClass=!0,this.width=306,this.height=400,this.type="medium",this.singleSeries=!1,this.xAxisFormatType=null,this.xAxisFormatString="",this.xAxisTitle=null,this.yAxisFormatType=null,this.yAxisFormatString="",this.yAxisTicks=5,this.yAxisMinBuffer=.01,this.yAxisMaxBuffer=.01,this.hideLegend=!1,this.legendWidth=133,this.legendPosition="right",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.marginTop=10,this.marginRight=0,this.marginBottom=30,this.marginLeft=55,this.threshold=null,this.thresholdLabel="Threshold",this.average=null,this.averageLabel="Average",this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.updateChart=function(){r.xAxisScale.domain(r.data.map((function(t){return t.label}))),r.yAxisScale.domain([d.min(r.data,(function(t){return t.value-t.value*+r.yAxisMinBuffer})),d.max(r.data,(function(t){return t.value+t.value*+r.yAxisMaxBuffer}))]).rangeRound([r.height,0]).nice(),r.xAxis.transition().duration(1e3).call(r.xAxisCall),r.yAxis.transition().duration(1e3).call(r.yAxisCall),r.hideXGrid||r.xGrid.transition().duration(1e3).call(r.xGridCall),r.hideYGrid||r.yGrid.transition().duration(1e3).call(r.yGridCall),r.hideGrayBars?r.svg.selectAll(".bar").data(r.data).join((function(t){return t.append("rect").attr("class","bar").attr("fill",(function(t){return"url("+r._location.path()+"#gradient-"+r.colorRange(t.label).substr(1)+")"})).attr("x",(function(t){return r.xAxisScale(t.label)+r.xAxisScale.bandwidth()/5.5})).attr("width",r.xAxisScale.bandwidth()/1.5).attr("y",r.height).attr("height",0).attr("pointer-events","none").call((function(t){return t.transition().duration(1e3).attr("y",(function(t){return r.yAxisScale(t.value)})).attr("height",(function(t){return r.height-r.yAxisScale(t.value)})).attr("data-color",(function(t){return r.colorRange(t.label)})).transition().attr("pointer-events","auto")}))}),(function(t){return t.attr("pointer-events","none").transition().duration(1e3).attr("x",(function(t){return r.xAxisScale(t.label)+r.xAxisScale.bandwidth()/5.5})).attr("width",r.xAxisScale.bandwidth()/1.5).attr("height",(function(t){return r.height-r.yAxisScale(t.value)})).attr("y",(function(t){return r.yAxisScale(t.value)})).transition().attr("pointer-events","auto")}),(function(t){return t.transition().attr("pointer-events","none").remove()})).on("mouseover",(function(t,e,i){return r.barMouseOver(n.event,t,e,i)})).on("mouseout",(function(t,e,i){return r.barMouseOut()})).on("click",(function(t,e,i){return r.barMouseClick(n.event,t,e,i)})):(r.svg.selectAll(".gray-bar").data(r.data).join((function(t){return t.append("rect").attr("class","gray-bar").attr("height",0).attr("x",(function(t){return r.xAxisScale(t.label)})).attr("width",r.xAxisScale.bandwidth()).call((function(t){return t.transition().duration(500).attr("height",r.height)}))}),(function(t){return t.transition().duration(1e3).attr("x",(function(t){return r.xAxisScale(t.label)})).attr("width",r.xAxisScale.bandwidth())}),(function(t){return t.transition().attr("pointer-events","none").remove()})),r.svg.selectAll(".bar").data(r.data).join((function(t){return t.append("rect").attr("class","bar").attr("fill",(function(t){return"url("+r._location.path()+"#gradient-"+r.colorRange(t.label).substr(1)+")"})).attr("x",(function(t){return r.xAxisScale(t.label)+r.xAxisScale.bandwidth()/4})).attr("width",r.xAxisScale.bandwidth()/2).attr("y",r.height).attr("height",0).attr("pointer-events","none").call((function(t){return t.transition().duration(1e3).attr("y",(function(t){return r.yAxisScale(t.value)})).attr("height",(function(t){return r.height-r.yAxisScale(t.value)})).attr("data-color",(function(t){return r.colorRange(t.label)})).transition().attr("pointer-events","auto")}))}),(function(t){return t.attr("pointer-events","none").transition().duration(1e3).attr("x",(function(t){return r.xAxisScale(t.label)+r.xAxisScale.bandwidth()/4})).attr("width",r.xAxisScale.bandwidth()/2).attr("height",(function(t){return r.height-r.yAxisScale(t.value)})).attr("y",(function(t){return r.yAxisScale(t.value)})).transition().attr("pointer-events","auto")}),(function(t){return t.transition().attr("pointer-events","none").remove()})).on("mouseover",(function(t,e,i){return r.barMouseOver(n.event,t,e,i)})).on("mouseout",(function(t,e,i){return r.barMouseOut()})).on("click",(function(t,e,i){return r.barMouseClick(n.event,t,e,i)}))),r.hideLegend||r.chart.select(".legend").selectAll(".legend-item").data(r.data).join((function(t){var e=t.insert("li","li.legend-static").attr("class","legend-item");return e.append("span").attr("class","legend-key").style("background-color",(function(t){return r.colorRange(t.label)})),e.append("span").attr("class","legend-label").html((function(t){switch(r.legendLabelFormatType){case"number":return r.legendLabelFormat(t.label);case"time":var e=h.isoParse(t.label);return r.legendLabelFormat(e);default:return t.label}})),e}),(function(t){return t.select(".legend-label").html((function(t){switch(r.legendLabelFormatType){case"number":return r.legendLabelFormat(t.label);case"time":var e=h.isoParse(t.label);return r.legendLabelFormat(e);default:return t.label}}))}),(function(t){return t.remove()})).on("mouseover",(function(t,e,i){return r.legendMouseOver(n.event,t,e,i)})).on("mouseout",(function(){return r.legendMouseOut()})).on("click",(function(t,e,i){return r.legendMouseClick(n.event,t,e,i)})),r.threshold&&r.yThreshold.raise().transition().duration(1e3).attr("transform","translate(0,  "+r.yAxisScale(+r.threshold)+")"),r.average&&r.yAverage.raise().transition().duration(1e3).attr("transform","translate(0,  "+r.yAxisScale(+r.average)+")")},this.barMouseOver=function(t,e,i,a){r.chart.selectAll(".bar").filter((function(t,e){return e!==i})).classed("inactive",!0);var n=r.chart.selectAll(".bar").filter((function(t,e){return e===i})),s=n.attr("data-color");n.style("fill",s),r.chart.selectAll(".legend-item").filter((function(t,e){return e!==i})).classed("inactive",!0),r.tooltipShow(e,a.filter((function(t,e){return e===i}))[0]),r.hovered.emit({event:t,data:e})},this.barMouseOut=function(){r.chart.selectAll(".bar").classed("inactive",!1).style("fill",null),r.chart.selectAll(".legend-item").classed("inactive",!1),r.tooltipHide()},this.barMouseClick=function(t,e,i,a){r.clicked.emit({event:t,data:e})},this.legendMouseOver=function(t,e,i,a){r.chart.selectAll(".legend-item").filter((function(t,e){return e!==i})).classed("inactive",!0),r.chart.selectAll(".bar").filter((function(t,e){return e!==i})).classed("inactive",!0);var n=r.chart.selectAll(".bar").filter((function(t,e){return e===i})),s=n.attr("data-color");n.style("fill",s),r.tooltipShow(e,r.chart.selectAll(".bar").filter((function(t,e){return e===i})).node()),r.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){r.chart.selectAll(".legend-item").classed("inactive",!1),r.chart.selectAll(".bar").classed("inactive",!1).style("fill",null),r.tooltipHide()},this.legendMouseClick=function(t,e,i,a){r.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e){var i,a=e.getBoundingClientRect(),n=r._scroll.getScrollPosition();switch(r.tooltipLabelFormatType){case"number":i=r.tooltipLabelFormat(t.label);break;case"time":var s=h.isoParse(t.label);i=r.tooltipLabelFormat(s);break;default:i=t.label}var o=null===r.tooltipValueFormat?'<div class="tooltip-value">'+t.value+"</div>":'<div class="tooltip-value">'+r.tooltipValueFormat(t.value)+"</div>";r.tooltip.html("\n        "+(r.hideTooltipLabel?"":""+i)+"\n        "+o+"\n      ");var l=+r.tooltip.node().offsetWidth/2,c=+r.tooltip.node().offsetHeight+8;r.tooltip.style("top",+n[1]+ +a.top-c+"px"),r.tooltip.style("left",+n[0]+ +a.left-l+ +a.width/2+"px"),r.tooltip.style("opacity",1)},this.tooltipHide=function(){r.tooltip.style("opacity",0)},this.xAxisFormatter=function(t){switch(r.xAxisFormatType){case"number":return r.xAxisFormat(t);case"time":var e=h.isoParse(t);return r.xAxisFormat(e);default:return t}},this.yAxisFormatter=function(t){switch(r.yAxisFormatType){case"number":return r.yAxisFormat(t);case"time":var e=h.isoParse(t);return r.yAxisFormat(e);default:return t}}}return t.prototype.ngOnInit=function(){var t=this;if(this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.xAxisFormat=this._dataviz.d3Format(this.xAxisFormatType,this.xAxisFormatString),this.yAxisFormat=this._dataviz.d3Format(this.yAxisFormatType,this.yAxisFormatString),this.legendLabelFormat=this._dataviz.d3Format(this.legendLabelFormatType,this.legendLabelFormatString),this.tooltipLabelFormat=this._dataviz.d3Format(this.tooltipLabelFormatType,this.tooltipLabelFormatString),this.tooltipValueFormat=this._dataviz.d3Format(this.tooltipValueFormatType,this.tooltipValueFormatString),this.hideGrayBars=!1,this.hideXAxis=!1,this.hideYAxis=!1,this.hideXAxisZero=!1,this.hideYAxisZero=!1,this.hideXGrid=!1,this.hideYGrid=!1,this.hideXAxisDomain=!1,this.hideYAxisDomain=!1,this.hideTooltip=!1,this.hideXAxisTicks=!1,this.hideYAxisTicks=!1,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.xAxisTitleMargin=this.xAxisTitle?20:0,this.yAxisTickSize=8,this.yAxisTickSizeOuter=0,this.hideTooltipLabel=!1,"debug"!==this.type){switch(this.type){case"low":this.hideGrayBars=!0,this.hideXAxis=!this.hideLegend,this.hideXAxisTicks=!0,this.hideXGrid=!0,this.hideYAxisDomain=!1,this.hideYAxisTicks=!0,this.legendPosition="bottom",this.hideTooltipLabel=!0;break;case"medium":this.hideXAxisDomain=!0,this.hideXAxis=!this.hideLegend,this.hideXGrid=!0,this.hideXAxisTicks=!0,this.hideYAxisDomain=!0,this.hideYAxisTicks=!0,this.hideYGrid=!0,this.hideTooltipLabel=!0;break;case"high":this.hideXAxis=!0,this.hideXAxisDomain=!0,this.hideXGrid=!0,this.hideYAxisDomain=!0,this.hideYAxisTicks=!0,this.hideYGrid=!0,this.hideLegend=!0,this.hideTooltipLabel=!1}this.singleSeries&&(this.hideLegend=!0,this.hideXAxis=!0,this.hideXGrid=!0,this.hideTooltipLabel=!1)}this.hideXAxis&&(this.margin.bottom=10),this.hideLegend||"right"!==this.legendPosition||(this.width=+this.width-+this.legendWidth),this.chart=n.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",+this.width).attr("height",+this.height+this.margin.top+this.margin.bottom+this.xAxisTitleMargin).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+ +this.width+" "+(+this.height+this.margin.top+this.margin.bottom+this.xAxisTitleMargin)),this.colorRange=s.scaleOrdinal().range(this._dataviz.createGradientDefs(this.svg,this.singleSeries,this.theme)),this.xAxisScale=s.scaleBand().domain(this.data.map((function(t){return t.label}))).rangeRound([0,this.width-this.margin.left]).align(0),this.hideGrayBars?this.xAxisScale.paddingInner(0).paddingOuter(0):this.xAxisScale.paddingInner(.1).paddingOuter(0),this.xAxisCall=u.axisBottom(this.xAxisScale).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.hideXGrid||(this.xGridCall=u.axisBottom(this.xAxisScale).tickSize(-this.height),this.xGrid=this.svg.append("g").attr("class","grid grid-x").classed("grid-zero-hidden",this.hideXAxisZero).attr("transform","translate(0, "+this.height+")").call(this.xGridCall)),this.xAxisTitle&&this.svg.append("text").attr("class","axis-title").attr("text-anchor","center").attr("x",this.width/2-this.margin.left).attr("y",this.height+this.margin.top+(this.hideXAxis?15:0)).text(this.xAxisTitle),this.yAxisScale=s.scaleLinear().domain([d.min(this.data,(function(e){return e.value-e.value*+t.yAxisMinBuffer})),d.max(this.data,(function(e){return e.value+e.value*+t.yAxisMaxBuffer}))]).nice().rangeRound([this.height,0]),this.yAxisCall=u.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.hideYGrid||(this.yGridCall=u.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(-this.width+this.margin.left+this.margin.right),this.yGrid=this.svg.append("g").attr("class","grid grid-y").classed("grid-zero-hidden",this.hideYAxisZero).attr("transform","translate(0, 0)").call(this.yGridCall)),this.threshold&&(this.yThreshold=this.svg.append("line").attr("class","threshold").attr("x2",+this.width-this.margin.right-this.margin.left).attr("transform","translate(0,  "+this.yAxisScale(+this.threshold)+")")),this.average&&(this.yAverage=this.svg.append("line").attr("class","average").attr("x2",+this.width-this.margin.right-this.margin.left).attr("transform","translate(0,  "+this.yAxisScale(+this.average)+")")),this.hideTooltip||(this.tooltip=n.select("body").append("div").attr("class","pbds-tooltip south").style("opacity",0).attr("aria-hidden","true")),this.hideLegend||(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.average&&!this.hideLegend&&this.chart.select(".legend").append("li").attr("class","legend-static legend-average").html((function(){return'\n          <span class="legend-key"></span>\n          <span class="legend-label">'+t.averageLabel+"</span>\n        "})),this.threshold&&!this.hideLegend&&this.chart.select(".legend").append("li").attr("class","legend-static legend-threshold").html((function(){return'\n          <span class="legend-key"></span>\n          <span class="legend-label">'+t.thresholdLabel+"</span>\n        "})),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t}();A.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-bar",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],A.ctorParameters=function(){return[{type:v},{type:e.ElementRef},{type:i.ViewportScroller},{type:i.Location}]},A.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],barClass:[{type:e.HostBinding,args:["class.pbds-chart-bar"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],type:[{type:e.Input}],singleSeries:[{type:e.Input}],xAxisFormatType:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],xAxisTitle:[{type:e.Input}],yAxisFormatType:[{type:e.Input}],yAxisFormatString:[{type:e.Input}],yAxisTicks:[{type:e.Input}],yAxisMinBuffer:[{type:e.Input}],yAxisMaxBuffer:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],threshold:[{type:e.Input}],thresholdLabel:[{type:e.Input}],average:[{type:e.Input}],averageLabel:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]};var S=0,F=function(){function t(t,i,a,s){var r=this;this._dataviz=t,this._element=i,this._scroll=a,this._location=s,this.chartClass=!0,this.lineClass=!0,this.width=306,this.height=400,this.type="medium",this.area=!1,this.xAxisFormatString="",this.xAxisTicks=6,this.yAxisFormatString="",this.yAxisTicks=5,this.yAxisMinBuffer=.01,this.yAxisMaxBuffer=.01,this.hideXGrid=!0,this.hideYGrid=!0,this.hideLegend=!1,this.legendWidth=133,this.legendPosition="right",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.tooltipHeadingFormatString="",this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.marginTop=10,this.marginRight=20,this.marginBottom=30,this.marginLeft=55,this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.tooltipHovered=new e.EventEmitter,this.tooltipClicked=new e.EventEmitter,this.updateChart=function(){r.mouserect.data(r.data),r.xAxisScale.domain(d.extent(r.data.dates,(function(t,e){return h.isoParse(t)}))),r.yAxisScale.domain([d.min(r.data.series,(function(t,e){var i=+d.min(t.values);return i-i*+r.yAxisMinBuffer})),d.max(r.data.series,(function(t,e){var i=+d.max(t.values);return i+i*r.yAxisMaxBuffer}))]).nice(),r.xAxis.transition().duration(1e3).call(r.xAxisCall),r.yAxis.transition().duration(1e3).call(r.yAxisCall),r.hideXGrid||r.xGrid.transition().duration(1e3).call(r.xGridCall),r.hideYGrid||r.yGrid.transition().duration(1e3).call(r.yGridCall),r.svg.selectAll("path.line").attr("filter",(function(){return"high"!==r.type?"url("+r._location.path()+"#glow)":null})).data(r.data.series).join((function(t){t.append("path").attr("clip-path","url("+r._location.path()+"#clip-path-"+r.clipPathId+")").attr("class","line").style("stroke",(function(t){return r.colorRange(t.label)})).style("stroke-width",r.lineWidth).attr("d",(function(t){var e=new Array(t.values.length).fill(0);return r.d3line(e)})).call((function(t){return t.transition().duration(1e3).ease(p.easeQuadInOut).attr("d",(function(t){return r.d3line(t.values)}))}))}),(function(t){return t.call((function(t){return t.transition().duration(1e3).ease(p.easeQuadInOut).attr("d",(function(t){return r.d3line(t.values)}))}))}),(function(t){return t.remove()})),r.area&&r.svg.selectAll("path.area").data(r.data.series).join((function(t){return t.append("path").attr("clip-path","url("+r._location.path()+"#clip-path-"+r.clipPathId+")").attr("class","area").attr("d",(function(t){var e=new Array(t.values.length).fill(0);return r.d3area(e)})).style("color",(function(t){return r.colorRange(t.label)})).call((function(t){return t.transition().duration(1e3).ease(p.easeQuadInOut).attr("d",(function(t){return r.d3area(t.values)}))}))}),(function(t){return t.call((function(t){return t.transition().duration(1e3).ease(p.easeQuadInOut).attr("d",(function(t){return r.d3area(t.values)}))}))}),(function(t){return t.remove()})),r.linePoints&&r.svg.selectAll("g.points").data(r.data.series).join((function(t){return t.append("g").attr("class","points").attr("clip-path","url("+r._location.path()+"#clip-path-points-"+r.clipPathId+")").style("color",(function(t,e){return r.colorRange(t.label)})).selectAll("circle").data((function(t){return t.values})).join((function(t){return t.append("circle").attr("cx",(function(t,e){return r.xAxisScale(h.isoParse(r.data.dates[e]))})).attr("cy",(function(t){return r.yAxisScale(0)})).attr("r",2*r.lineWidth).style("stroke-width",r.lineWidth).call((function(t){return t.transition().duration(1e3).ease(p.easeQuadInOut).attr("cy",(function(t){return r.yAxisScale(t)}))}))}),(function(){}),(function(t){return t.remove()}))}),(function(t){return t.selectAll("circle").data((function(t){return t.values})).join((function(t){return t.append("circle").attr("cx",(function(t,e){return r.xAxisScale(h.isoParse(r.data.dates[e]))})).attr("cy",(function(t){return r.yAxisScale(t)})).attr("r",2*r.lineWidth).style("stroke-width",r.lineWidth)}),(function(t){return t.call((function(t){return t.transition().duration(1e3).ease(p.easeQuadInOut).attr("cx",(function(t,e){return r.xAxisScale(h.isoParse(r.data.dates[e]))})).attr("cy",(function(t){return r.yAxisScale(t)}))}))}),(function(t){return t.remove()}))}),(function(t){return t.remove()})),r.hideLegend||r.chart.select(".legend").selectAll(".legend-item").data(r.data.series).join((function(t){var e=t.append("li").attr("class","legend-item");return e.append("span").attr("class","legend-key").style("background-color",(function(t){return r.colorRange(t.label)})),e.append("span").attr("class","legend-label").html((function(t){switch(r.legendLabelFormatType){case"number":return r.legendLabelFormat(t.label);case"time":var e=h.isoParse(t.label);return r.legendLabelFormat(e);default:return t.label}})),e}),(function(t){return t.select(".legend-label").html((function(t){switch(r.legendLabelFormatType){case"number":return r.legendLabelFormat(t.label);case"time":var e=h.isoParse(t.label);return r.legendLabelFormat(e);default:return t.label}})),t}),(function(t){return t.remove()})).on("mouseover",(function(t,e,i){return r.legendMouseOver(n.event,t,e,i)})).on("mouseout",(function(){return r.legendMouseOut()})).on("click",(function(t,e,i){return r.legendMouseClick(n.event,t,e,i)})),r.hideTooltip||r.tooltip.select(".tooltip-table").selectAll("tr").data(r.data.series).join((function(t){var e=t.append("tr").attr("class","tooltip-item");return e.append("td").style("color",(function(t){return r.colorRange(t.label)})).append("span").attr("class","pbds-tooltip-key"),e.append("td").attr("class","tooltip-label pr-2 text-nowrap").html((function(t){return r.tooltipLabelFormatType?r.tooltipLabelFormat(t.label):t.label})),e.append("td").attr("class","tooltip-value text-right text-nowrap").html((function(t){return""})),e}),(function(){}),(function(t){return t.remove()})),r.svg.selectAll(".points").raise(),r.mouserect.raise()},this.legendMouseOver=function(t,e,i,a){r.chart.selectAll(".legend-item").filter((function(t,e){return e!==i})).classed("inactive",!0),r.svg.selectAll(".line").filter((function(t,e){return e!==i})).classed("inactive",!0),r.svg.selectAll(".line").filter((function(t,e){return e===i})).classed("active",!0),r.area&&r.svg.selectAll(".area").filter((function(t,e){return e!==i})).classed("inactive",!0),r.linePoints&&r.svg.selectAll(".points").filter((function(t,e){return e!==i})).selectAll("circle").classed("inactive",!0),r.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){r.chart.selectAll(".legend-item").classed("inactive",!1),r.chart.selectAll(".line").classed("inactive",!1).classed("active",!1),r.linePoints&&r.svg.selectAll("circle").classed("active",!1).classed("inactive",!1),r.area&&r.svg.selectAll(".area").classed("inactive",!1)},this.legendMouseClick=function(t,e,i,a){r.clicked.emit({event:t,data:e})},this.mouserectMouseMove=function(t,e,i){var a=r.xAxisScale.invert(n.mouse(i[0])[0]),s=d.bisectLeft(r.data.dates,h.isoFormat(a));if(0===s)return!1;var o=new Date(r.data.dates[s-1]),l=new Date(r.data.dates[s]),c=+a-+o>+l-a?l:o,u=r.data.dates.indexOf(h.isoFormat(c)),p=r.svg.selectAll(".line-group").selectAll("circle");p.filter((function(t,e){return e===u})).classed("active",!0),p.filter((function(t,e){return e!==u})).classed("active",!1),r.tooltipLine.attr("x1",r.xAxisScale(c)).attr("x2",r.xAxisScale(c)).classed("active",!0),r.tooltipShow(r.tooltipLine.node(),u),r.mousedata={date:c,series:r.data.series.map((function(t){return{label:t.label,value:t.values[u]}}))},r.tooltipHovered.emit({event:t,data:r.mousedata})},this.mouserectMouseOut=function(t,e,i){r.svg.selectAll("circle").classed("active",!1),r.tooltipLine.classed("active",!1),r.tooltipHide()},this.mouserectMouseClick=function(){r.tooltipClicked.emit({event:event,data:r.mousedata})},this.tooltipShow=function(t,e){var i,a=r._scroll.getScrollPosition(),n=t.getBoundingClientRect(),s=+r.tooltip.node().offsetHeight,o=r.tooltip.node().getBoundingClientRect(),l=n.left+o.width+8,c=document.body.clientWidth-10;r.tooltip.select(".tooltip-header").html((function(t){var i=h.isoParse(r.data.dates[e]);return r.tooltipHeadingFormat(i)})),r.tooltip.selectAll(".tooltip-value").html((function(t,i){return r.tooltipValueFormatType?r.tooltipValueFormat(r.data.series[i].values[e]):r.data.series[i].values[e]})),l>c?(r.tooltip.classed("east",!0),r.tooltip.classed("west",!1),i=n.left-o.width-8+"px"):l<c&&(r.tooltip.classed("east",!1),r.tooltip.classed("west",!0),i=n.left+8+"px"),r.tooltip.style("top",n.top+n.height/2-s/2+a[1]+"px"),r.tooltip.style("left",i),r.tooltip.style("opacity",1)},this.tooltipHide=function(){r.tooltip.style("opacity",0)},this.xAxisFormatter=function(t){var e=h.isoParse(t);return r.xAxisFormat(e)},this.yAxisFormatter=function(t){return r.yAxisFormat(t)}}return t.prototype.ngOnInit=function(){var t=this;if(this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.clipPathId=S,this.xAxisFormat=h.timeFormat(this.xAxisFormatString),this.yAxisFormat=l.format(this.yAxisFormatString),this.legendLabelFormat=this._dataviz.d3Format(this.legendLabelFormatType,this.legendLabelFormatString),this.tooltipHeadingFormat=h.timeFormat(this.tooltipHeadingFormatString),this.tooltipLabelFormat=this._dataviz.d3Format(this.tooltipLabelFormatType,this.tooltipLabelFormatString),this.tooltipValueFormat=this._dataviz.d3Format(this.tooltipValueFormatType,this.tooltipValueFormatString),this.lineWidth=3,this.lineCurved=!0,this.linePoints=!0,this.hideXAxis=!1,this.hideYAxis=!1,this.hideXAxisZero=!1,this.hideYAxisZero=!1,this.hideXAxisDomain=!1,this.hideYAxisDomain=!1,this.hideTooltip=!1,this.hideXAxisTicks=!1,this.hideYAxisTicks=!1,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.yAxisTickSize=8,this.yAxisTickSizeOuter=0,"debug"!==this.type)switch(this.type){case"medium":this.hideXAxisTicks=!0,this.hideYAxisTicks=!0;break;case"high":this.lineWidth=2,this.lineCurved=!1,this.linePoints=!1,this.hideXAxisTicks=!0,this.hideYAxisTicks=!0,this.hideXGrid=!1,this.hideYGrid=!1}(this.hideXAxis&&(this.margin.bottom=10),this.hideLegend||"right"!==this.legendPosition||(this.width=+this.width-+this.legendWidth),this.d3line=r.line().x((function(e,i){return t.xAxisScale(h.isoParse(t.data.dates[i]))})).y((function(e){return t.yAxisScale(e)})),this.lineCurved&&this.d3line.curve(r.curveCatmullRom.alpha(.5)),this.area&&(this.d3area=r.area().x((function(e,i){return t.xAxisScale(h.isoParse(t.data.dates[i]))})).y0(this.height).y1((function(e,i){return t.yAxisScale(e)})),this.lineCurved&&this.d3area.curve(r.curveCatmullRom.alpha(.5))),this.chart=n.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",+this.width+this.margin.right).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+(+this.width+this.margin.right)+" "+(+this.height+this.margin.top+this.margin.bottom)),this.mouserect=this.svg.append("rect").attr("width",this.width-this.margin.left-this.margin.right).attr("height",this.height).attr("class","mouserect").on("mousemove",(function(e,i,a){return t.mouserectMouseMove(n.event,i,a)})).on("mouseout",(function(e,i,a){return t.mouserectMouseOut(n.event,i,a)})).on("click",(function(e,i,a){return t.mouserectMouseClick()})),this.tooltipLine=this.svg.append("line").attr("y1",0).attr("y2",this.height).attr("class","tooltip-line"),this.colorRange=s.scaleOrdinal().range(this._dataviz.getColors(!1,this.theme)),this._dataviz.createGlowFilter(this.svg),this.xAxisScale=s.scaleTime().domain(d.extent(this.data.dates,(function(t,e){return h.isoParse(t)}))).range([0,this.width-this.margin.left-this.margin.right]),this.xAxisCall=u.axisBottom(this.xAxisScale).ticks(+this.xAxisTicks).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.hideXGrid||(this.xGridCall=u.axisBottom(this.xAxisScale).tickSize(-this.height),this.xGrid=this.svg.append("g").attr("class","grid grid-x").classed("grid-zero-hidden",this.hideXAxisZero).attr("transform","translate(0, "+this.height+")").call(this.xGridCall)),this.yAxisScale=s.scaleLinear().domain([d.min(this.data.series,(function(e,i){var a=+d.min(e.values);return a-a*+t.yAxisMinBuffer})),d.max(this.data.series,(function(e,i){var a=+d.max(e.values);return a+a*t.yAxisMaxBuffer}))]).nice().range([this.height,0]),this.yAxisCall=u.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.hideYGrid||(this.yGridCall=u.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(-this.width+this.margin.left+this.margin.right),this.yGrid=this.svg.append("g").attr("class","grid grid-y").classed("grid-zero-hidden",this.hideYAxisZero).attr("transform","translate(0, 0)").call(this.yGridCall)),this.hideTooltip)||(this.tooltip=n.select("body").append("div").attr("class","pbds-tooltip west").style("opacity",0).attr("aria-hidden","true"),this.tooltip.append("div").attr("class","tooltip-header"),this.tooltip.append("table").attr("class","tooltip-table text-left w-100").append("tbody").selectAll("tr").data(this.data).join((function(t){return t.append("tr")})));this.hideLegend||(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.svg.append("clipPath").attr("id","clip-path-"+this.clipPathId).append("rect").attr("width",+this.width-+this.margin.left-+this.margin.right).attr("height",+this.height),this.svg.append("clipPath").attr("id","clip-path-points-"+this.clipPathId).append("rect").attr("width",+this.width+ +this.margin.left-+this.margin.right).attr("height",+this.height).attr("transform","translate(-"+this.margin.left+", 0)"),this.updateChart(),S++},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t}();F.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-line",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],F.ctorParameters=function(){return[{type:v},{type:e.ElementRef},{type:i.ViewportScroller},{type:i.Location}]},F.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],lineClass:[{type:e.HostBinding,args:["class.pbds-chart-line"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],type:[{type:e.Input}],area:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],xAxisTicks:[{type:e.Input}],yAxisFormatString:[{type:e.Input}],yAxisTicks:[{type:e.Input}],yAxisMinBuffer:[{type:e.Input}],yAxisMaxBuffer:[{type:e.Input}],hideXGrid:[{type:e.Input}],hideYGrid:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],tooltipHeadingFormatString:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}],tooltipHovered:[{type:e.Output}],tooltipClicked:[{type:e.Output}]};var k=function(){function t(t,e){var i=this;this._dataviz=t,this._element=e,this.chartClass=!0,this.gaugeClass=!0,this.width=300,this.type="halfmoon",this.color="#E23DA8",this.hideLabel=!1,this.labelFormatString="",this.gaugeWidth=20,this.degreesToRadians=function(t){return t*Math.PI/180},this.calculateMinMax=function(){return i.data.minvalue/(i.data.maxvalue-i.data.minvalue)*(i.data.value-i.data.minvalue)+(i.data.value-i.data.minvalue)},this.calculateCurve=function(t){var e=i.degreesToRadians(i.startAngle);return[{startAngle:e,endAngle:e+t*(i.degreesToRadians(i.endAngle)-e)/i.data.maxvalue}]},this.drawChart=function(){switch(i.gauge=i.svg.append("g").attr("class","gauge-group"),i.gauge.append("path").data(i.calculateCurve(i.data.maxvalue)).attr("class","gauge-background").attr("d",(function(t){return i.arc({innerRadius:i.radius-i.gaugeWidth,outerRadius:i.radius,startAngle:t.startAngle,endAngle:t.endAngle})})),i.gauge.append("path").data(i.calculateCurve(i.calculateMinMax())).attr("class","gauge-value").attr("fill",i.color).attr("d",(function(t){return i.arc({innerRadius:i.radius-i.gaugeWidth,outerRadius:i.radius,startAngle:t.startAngle,endAngle:t.endAngle})})),i.type){case"horseshoe":i.svg.attr("height",230).attr("viewBox","-"+i.width/2+" -"+i.height/2+" "+i.height+" 230");break;case"halfmoon":i.svg.attr("height",i.width/2),i.svg.attr("viewBox","-"+i.width/2+" -"+i.width/2+" "+i.width+" "+i.width/2)}},this.updateChart=function(){i.svg.select(".gauge-group").select(".gauge-value").transition().duration(750).call(i.arcTween,i.calculateMinMax()),i.labelTween=i.chart.select(".gauge-number"),i.labelTween.transition().duration(750).call(i.textTween,i.data.value)},this.arcTween=function(t,e){var a=i.calculateCurve(e);t.attrTween("d",(function(t){var e=o.interpolate(t.endAngle,a[0].endAngle);return function(a){return t.endAngle=e(a),i.arc({innerRadius:i.radius-i.gaugeWidth,outerRadius:i.radius,startAngle:t.startAngle,endAngle:t.endAngle})}}))},this.textTween=function(t,e){e=(e=l.format(".4f")(e)).replace(/,/g,"."),t.tween("text",(function(){var t=o.interpolate(l.format(".4f")(+i.oldValue),e);return function(e){i.labelTween.text((function(a){var n=i.labelFormat(t(e));return i.label=n,n}))}}))}}return t.prototype.ngOnInit=function(){switch(this.height=this.width,this.radius=Math.max(this.width,this.height)/2,this.labelFormat=l.format(this.labelFormatString),this.label=this.labelFormat(this.data.value),this.type){case"halfmoon":this.startAngle=-90,this.endAngle=90,this.rounded=!0;break;case"horseshoe":this.startAngle=-140,this.endAngle=140,this.rounded=!0;break;case"circle":this.startAngle=0,this.endAngle=360,this.rounded=!1}this.arc=r.arc().cornerRadius(this.rounded?this.gaugeWidth:0),this.chart=n.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",this.width).attr("height",this.height).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.width/2+" -"+this.height/2+" "+this.width+" "+this.height),this.drawChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&(this.oldValue=t.data.previousValue.value,this.updateChart())},t}();k.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-gauge",template:'\n    <div\n      *ngIf="!hideLabel"\n      class="gauge-details"\n      [ngClass]="{ halfmoon: type === \'halfmoon\', \'gauge-details-small\': type === \'halfmoon\' }"\n      [ngStyle]="{ \'max-width.px\': width - 3 * gaugeWidth }"\n    >\n      <div class="gauge-number">{{ label }}</div>\n      <div *ngIf="description" class="gauge-description text-center">{{ description }}</div>\n    </div>\n  '}]}],k.ctorParameters=function(){return[{type:v},{type:e.ElementRef}]},k.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],gaugeClass:[{type:e.HostBinding,args:["class.pbds-chart-gauge"]}],data:[{type:e.Input}],width:[{type:e.Input}],type:[{type:e.Input}],color:[{type:e.Input}],hideLabel:[{type:e.Input}],labelFormatString:[{type:e.Input}],description:[{type:e.Input}],gaugeWidth:[{type:e.Input}]};var w=function(){function t(t){this._element=t,this.chartClass=!0,this.sparklineClass=!0,this.width=160,this.height=40,this.type="line",this.color="#E23DA8",this.colorNegative=null,this.strokeWidth=2,this.yAxisMinBuffer=0,this.yAxisMaxBuffer=0}return t.prototype.ngOnInit=function(){this.margin={top:1,right:0,bottom:1,left:0},"bar"===this.type&&(this.margin={top:0,right:0,bottom:0,left:0}),"line-high"!==this.type&&"area-high"!==this.type||(this.strokeWidth=1),null===this.colorNegative&&(this.colorNegative=this.color),this.chart=n.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",this.width).attr("height",this.height).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+this.width+" "+this.height),"line"!==this.type&&"line-high"!==this.type&&"area"!==this.type&&"area-high"!==this.type||this.svg.append("path").attr("class","sparkline").attr("fill","none").attr("stroke-width",this.strokeWidth).attr("stroke",this.color),"area"!==this.type&&"area-high"!==this.type||this.svg.append("path").attr("class","sparkarea").attr("fill",this.color).attr("fill-opacity",.3),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.updateChart=function(){var t=this,e=this.data,i=s.scaleLinear().domain([0,this.data.length]).range([0,this.width-this.margin.left-this.margin.right]),a=s.scaleLinear().domain([+d.min(this.data)-this.yAxisMinBuffer,+d.max(this.data)+this.yAxisMaxBuffer]).range([this.height-this.margin.top-this.margin.bottom,0]),n=r.line().x((function(t,e){return i(e)})).y((function(t){return a(t)})),o=r.area().x((function(t,e){return i(e)})).y0(this.height).y1((function(t){return a(t)}));if("line"!==this.type&&"line-high"!==this.type&&"area"!==this.type&&"area-high"!==this.type||this.svg.selectAll(".sparkline").transition().duration(1e3).attr("d",(function(){return n(e)})),"area"!==this.type&&"area-high"!==this.type||this.svg.selectAll(".sparkarea").transition().duration(1e3).attr("d",(function(){return o(e)})),"bar"===this.type){var l=(this.width-this.data.length)/this.data.length;this.svg.selectAll(".sparkbar").data(this.data).join((function(e){return e.append("rect").attr("class","sparkbar").attr("x",(function(t,e){return i(e)})).attr("y",t.height).attr("width",l).attr("fill",(function(e){return e>0?t.color:t.colorNegative})).attr("height",0).call((function(t){return t.transition().duration(1e3).attr("y",(function(t){return a(t>0?t:0)})).attr("height",(function(t){return Math.abs(a(t)-a(0))})),t}))}),(function(e){return e.transition().duration(1e3).attr("x",(function(t,e){return i(e)})).attr("y",(function(t){return a(t>0?t:0)})).attr("width",l).attr("height",(function(t){return Math.abs(a(t)-a(0))})).attr("fill",(function(e){return e>0?t.color:t.colorNegative}))}),(function(t){return t.remove()}))}},t}();w.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-sparkline",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],w.ctorParameters=function(){return[{type:e.ElementRef}]},w.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],sparklineClass:[{type:e.HostBinding,args:["class.pbds-chart-sparkline"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],type:[{type:e.Input}],color:[{type:e.Input}],colorNegative:[{type:e.Input}],strokeWidth:[{type:e.Input}],yAxisMinBuffer:[{type:e.Input}],yAxisMaxBuffer:[{type:e.Input}]};var T=function(){function t(t,i,a){var s=this;this._dataviz=t,this._element=i,this._scroll=a,this.chartClass=!0,this.stackedBarClass=!0,this.width=306,this.height=400,this.type="medium",this.marginTop=10,this.marginRight=0,this.marginBottom=30,this.marginLeft=55,this.hideXAxis=!1,this.xAxisFormatType=null,this.xAxisFormatString="",this.yAxisFormatType=null,this.yAxisFormatString="",this.yAxisTicks=5,this.yAxisMaxBuffer=.01,this.hideLegend=!1,this.legendWidth=133,this.legendPosition="right",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.tooltipHeadingFormatType=null,this.tooltipHeadingFormatString="",this.tooltipHeadingValueFormatType=null,this.tooltipHeadingValueFormatString="",this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.updateChart=function(t){void 0===t&&(t=!0),s.dataKeys=Object.keys(s.data[0]).filter((function(t){return"key"!==t})),s.dataStack=r.stack().keys(s.dataKeys).order(r.stackOrderNone)(s.data),s.xAxisScale.domain(s.data.map((function(t){return t.key}))),s.yAxisMax=d.max(s.dataStack,(function(t){return d.max(t,(function(t){return t[1]}))})),s.yAxisMax=s.yAxisMax+s.yAxisMax*s.yAxisMaxBuffer,s.yAxisScale.domain([0,s.yAxisMax]).rangeRound([s.height,0]).nice(),s.xAxis.transition().duration(0).call(s.xAxisCall),s.yAxis.transition().duration(0).call(s.yAxisCall),s.hideXGrid||s.xGrid.transition().duration(0).call(s.xGridCall),s.hideYGrid||s.yGrid.transition().duration(0).call(s.yGridCall),s.hideGrayBars||s.grayBars.selectAll(".gray-bar").data(s.data).join((function(t){return t.append("rect").attr("class","gray-bar").attr("x",(function(t){return s.xAxisScale(t.key)})).attr("width",s.xAxisScale.bandwidth()).attr("height",s.height)}),(function(e){return e.transition().duration((function(e,i,a){return t?0:1e3})).attr("x",(function(t){return s.xAxisScale(t.key)})).attr("width",s.xAxisScale.bandwidth()).attr("height",s.height)}),(function(t){return t.remove()})),s.bars.selectAll(".bar-group").data(s.dataStack).join((function(t){return t.append("g").attr("class","bar-group").attr("fill",(function(t){return s.colorRange(t.index)}))}),(function(t){return t.attr("fill",(function(t){return s.colorRange(t.index)}))}),(function(t){return t.remove()})).selectAll(".bar").data((function(t){return t})).join((function(e){return e.append("rect").attr("class","bar").classed("bar-divided","high"!==s.type).classed("bar-divided-low","low"===s.type).attr("x",(function(t,e){return"medium"===s.type?s.xAxisScale(t.data.key)+s.xAxisScale.bandwidth()/8*3:s.xAxisScale(t.data.key)+s.xAxisScale.bandwidth()/4*1})).attr("y",(function(t){return s.yAxisScale(t[0])})).attr("width",(function(t){return"medium"===s.type?s.xAxisScale.bandwidth()/4:s.xAxisScale.bandwidth()/2})).attr("height",0).call((function(e){return e.transition().duration((function(e,i,a){return t?0:500})).delay((function(e,i,a){return t?0:750})).attr("y",(function(t){return s.yAxisScale(t[1])})).attr("height",(function(t){return s.yAxisScale(t[0])-s.yAxisScale(t[1])})),e}))}),(function(t){return t.call((function(t){return t.transition().duration(1e3).attr("width",s.xAxisScale.bandwidth()/4).attr("x",(function(t,e){return s.xAxisScale(t.data.key)+s.xAxisScale.bandwidth()/8*3})).attr("y",(function(t){return s.yAxisScale(t[1])})).attr("height",(function(t){return s.yAxisScale(t[0])-s.yAxisScale(t[1])})),t}))}),(function(t){return t.remove()})),s.mouseBars.selectAll(".mouseover-bar").data(s.data).join((function(t){return t.append("rect").attr("class","mouseover-bar").style("opacity",0).attr("x",(function(t){return s.xAxisScale(t.key)})).attr("width",s.xAxisScale.bandwidth()).attr("height",s.height)}),(function(t){return t.attr("pointer-events","none").attr("x",(function(t){return s.xAxisScale(t.key)})).attr("width",s.xAxisScale.bandwidth()).attr("height",s.height).transition().attr("pointer-events","auto")}),(function(t){return t.transition().attr("pointer-events","none").remove()})).on("mouseover",(function(t,e,i){return s.barMouseOver(n.event,t,e,i)})).on("mouseout",(function(t,e,i){return s.barMouseOut()})).on("click",(function(t,e,i){return s.barMouseClick(n.event,t,e,i)})),s.bars.raise(),s.xAxis.raise(),s.mouseBars.raise(),s.hideLegend||s.chart.select(".legend").selectAll(".legend-item").data(s.dataStack).join((function(t){var e=t.append("li").attr("class","legend-item");return e.append("span").attr("class","legend-key").style("background-color",(function(t){return s.colorRange(t.index)})),e.append("span").attr("class","legend-label").html((function(t){switch(s.legendLabelFormatType){case"number":return s.legendLabelFormat(t.key);case"time":var e=h.isoParse(t.key);return s.legendLabelFormat(e);default:return t.key}})),e}),(function(t){return t.select(".legend-label").html((function(t){switch(s.legendLabelFormatType){case"number":return s.legendLabelFormat(t.key);case"time":var e=h.isoParse(t.key);return s.legendLabelFormat(e);default:return t.key}})),t}),(function(t){return t.remove()})).on("mouseover",(function(t,e,i){return s.legendMouseOver(n.event,t,e,i)})).on("mouseout",(function(){return s.legendMouseOut()})).on("click",(function(t,e,i){return s.legendMouseClick(n.event,t,e,i)}))},this.barMouseOver=function(t,e,i,a){s.chart.selectAll(".bar-group").selectAll(".bar").filter((function(t,e){return e!==i})).classed("inactive",!0),s.tooltipShow(e,i,a[i]),s.hovered.emit({event:t,data:e})},this.barMouseOut=function(){s.chart.selectAll(".bar").classed("inactive",!1),s.tooltipHide()},this.barMouseClick=function(t,e,i,a){s.clicked.emit({event:t,data:e})},this.legendMouseOver=function(t,e,i,a){s.chart.selectAll(".legend-item").filter((function(t,e){return e!==i})).classed("inactive",!0),s.chart.selectAll(".bar-group").filter((function(t,e){return e!==i})).classed("inactive",!0),s.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){s.chart.selectAll(".legend-item").classed("inactive",!1),s.chart.selectAll(".bar-group").classed("inactive",!1),s.tooltipHide()},this.legendMouseClick=function(t,e,i,a){s.clicked.emit({event:t,data:e})},this.xAxisFormatter=function(t){switch(s.xAxisFormatType){case"number":return s.xAxisFormat(t);case"time":var e=h.isoParse(t);return s.xAxisFormat(e);default:return t}},this.tooltipShow=function(t,e,i){var a,n,r,o,l,c=s._scroll.getScrollPosition(),d=i.getBoundingClientRect(),u=document.body.clientWidth-10;s.tooltip.select(".tooltip-header").html((function(e){switch(s.tooltipHeadingFormatType){case"time":var i=h.isoParse(t.key);return s.tooltipHeadingFormat(i);default:return t.key}})),s.tooltip.select(".tooltip-header-value").html((function(e){var i=0;return Object.keys(t).map((function(e){"key"!==e&&(i+=t[e])})),s.tooltipHeadingValueFormat(i)})),s.tooltip.select(".tooltip-table").select("tbody").html((function(e){var i,a,n="";return Object.keys(t).map((function(e,r){switch(s.tooltipLabelFormatType){case"time":var o=h.isoParse(e);i=s.tooltipHeadingFormat(o);break;default:i=e}switch(s.tooltipValueFormatType){case"number":a=s.tooltipValueFormat(t[e]);break;default:a=t[e]}"key"!==e&&(n+="\n              <tr class='tooltip-item'>\n                <td style=\"color: "+s.colorRange(r-1)+'">\n                  <span class="pbds-tooltip-key"></span>\n                </td>\n                <td class="tooltip-label pr-2 text-nowrap">'+i+'</td>\n                <td class="tooltip-value text-right text-nowrap">'+a+"</td>\n              </tr>\n            ")})),n})),n=s.tooltip.node().getBoundingClientRect(),a=d.left+d.width+n.width+8,r=+s.tooltip.node().offsetHeight,a>u?(s.tooltip.classed("east",!0),s.tooltip.classed("west",!1),l="medium"===s.type?d.left+d.width/8*3-n.width-8+"px":d.left+d.width/4*1-n.width-8+"px"):a<u&&(s.tooltip.classed("east",!1),s.tooltip.classed("west",!0),l="medium"===s.type?d.left+d.width/8*5+8+"px":d.left+d.width/4*3+8+"px"),o=s.svg.selectAll(".bar-group").filter(":last-child").selectAll(".bar").filter((function(t,i){return i===e})).node().getBoundingClientRect(),s.tooltip.style("top",o.top-r/2+c[1]+"px"),s.tooltip.style("left",l),s.tooltip.style("opacity",1)},this.tooltipHide=function(){s.tooltip.style("opacity",0)},this.yAxisFormatter=function(t){switch(s.yAxisFormatType){case"number":return s.yAxisFormat(t);case"time":var e=h.isoParse(t);return s.yAxisFormat(e);default:return t}}}return t.prototype.ngOnInit=function(){if(this.dataKeys=Object.keys(this.data[0]).filter((function(t){return"key"!==t})),this.dataStack=r.stack().keys(this.dataKeys).order(r.stackOrderNone)(this.data),this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.xAxisFormat=this._dataviz.d3Format(this.xAxisFormatType,this.xAxisFormatString),this.yAxisFormat=this._dataviz.d3Format(this.yAxisFormatType,this.yAxisFormatString),this.legendLabelFormat=this._dataviz.d3Format(this.legendLabelFormatType,this.legendLabelFormatString),this.tooltipHeadingFormat=this._dataviz.d3Format(this.tooltipHeadingFormatType,this.tooltipHeadingFormatString),this.tooltipHeadingValueFormat=this._dataviz.d3Format(this.tooltipHeadingValueFormatType,this.tooltipHeadingValueFormatString),this.tooltipLabelFormat=this._dataviz.d3Format(this.tooltipLabelFormatType,this.tooltipLabelFormatString),this.tooltipValueFormat=this._dataviz.d3Format(this.tooltipValueFormatType,this.tooltipValueFormatString),this.hideGrayBars=!1,this.hideYAxis=!1,this.hideXAxisZero=!1,this.hideYAxisZero=!1,this.hideXGrid=!1,this.hideYGrid=!1,this.hideXAxisDomain=!1,this.hideYAxisDomain=!1,this.hideTooltip=!1,this.hideXAxisTicks=!1,this.hideYAxisTicks=!1,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.yAxisTickSize=8,this.yAxisTickSizeOuter=0,"debug"!==this.type)switch(this.type){case"low":this.hideGrayBars=!0,this.hideXAxisTicks=!0,this.hideXGrid=!0,this.hideYAxisDomain=!1,this.hideYAxisTicks=!0,this.legendPosition="bottom";break;case"medium":this.hideXAxisDomain=!0,this.hideXGrid=!0,this.hideXAxisTicks=!0,this.hideYAxisDomain=!0,this.hideYAxisTicks=!0,this.hideYGrid=!0;break;case"high":this.hideXAxis=!0,this.hideXAxisTicks=!0,this.hideXAxisDomain=!0,this.hideXGrid=!0,this.hideYAxisDomain=!0,this.hideYAxisTicks=!0,this.hideYGrid=!0,this.hideLegend=!1,this.legendPosition="bottom"}this.hideXAxis&&(this.margin.bottom=10),this.hideLegend||"right"!==this.legendPosition||(this.width=+this.width-+this.legendWidth),this.chart=n.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",+this.width).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+ +this.width+" "+(+this.height+this.margin.top+this.margin.bottom)),this.grayBars=this.svg.append("g").attr("class","gray-bars"),this.mouseBars=this.svg.append("g").attr("class","mouseover-bars"),this.bars=this.svg.append("g").attr("class","bars"),this.colorRange=s.scaleOrdinal().range(this._dataviz.getColors(!1,this.theme)),this.xAxisScale=s.scaleBand().domain(this.data.map((function(t){return t.key}))).rangeRound([0,this.width-this.margin.left]).align(0),this.hideGrayBars?this.xAxisScale.paddingInner(0).paddingOuter(0):this.xAxisScale.paddingInner(.1).paddingOuter(0),this.xAxisCall=u.axisBottom(this.xAxisScale).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.hideXGrid||(this.xGridCall=u.axisBottom(this.xAxisScale).tickSize(-this.height),this.xGrid=this.svg.append("g").attr("class","grid grid-x").classed("grid-zero-hidden",this.hideXAxisZero).attr("transform","translate(0, "+this.height+")").call(this.xGridCall)),this.yAxisMax=d.max(this.dataStack,(function(t){return d.max(t,(function(t){return t[1]}))})),this.yAxisMax=this.yAxisMax+this.yAxisMax*this.yAxisMaxBuffer,this.yAxisScale=s.scaleLinear().domain([0,this.yAxisMax]).nice().rangeRound([this.height,0]),this.yAxisCall=u.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.hideYGrid||(this.yGridCall=u.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(-this.width+this.margin.left+this.margin.right),this.yGrid=this.svg.append("g").attr("class","grid grid-y").classed("grid-zero-hidden",this.hideYAxisZero).attr("transform","translate(0, 0)").call(this.yGridCall)),this.hideTooltip||(this.tooltip=n.select("body").append("div").attr("class","pbds-tooltip west").style("opacity",0).attr("aria-hidden","true"),this.tooltip.append("div").attr("class","tooltip-header"),this.tooltip.append("div").attr("class","tooltip-header-value"),this.tooltip.append("table").attr("class","tooltip-table text-left w-100").append("tbody")),this.hideLegend||(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart(!1)},t}();T.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-bar-stacked",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],T.ctorParameters=function(){return[{type:v},{type:e.ElementRef},{type:i.ViewportScroller}]},T.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],stackedBarClass:[{type:e.HostBinding,args:["class.pbds-chart-stacked-bar"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],type:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],hideXAxis:[{type:e.Input}],xAxisFormatType:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],yAxisFormatType:[{type:e.Input}],yAxisFormatString:[{type:e.Input}],yAxisTicks:[{type:e.Input}],yAxisMaxBuffer:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],tooltipHeadingFormatType:[{type:e.Input}],tooltipHeadingFormatString:[{type:e.Input}],tooltipHeadingValueFormatType:[{type:e.Input}],tooltipHeadingValueFormatString:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]};var C=function(){function t(){this.value=0,this.class="",this.indicator="flat",this.inverse=!1}return Object.defineProperty(t.prototype,"hostClasses",{get:function(){return["metric-block-indicator",this.indicator,this.inverse?"inverse":"",this.class].join(" ")},enumerable:!1,configurable:!0}),t}();C.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-metric-indicator",template:"\n    <span>{{ value }}</span>\n  "}]}],C.propDecorators={value:[{type:e.Input}],class:[{type:e.Input}],indicator:[{type:e.Input}],inverse:[{type:e.Input}],hostClasses:[{type:e.HostBinding,args:["class"]}]};var I=function(){function t(){this.class="",this.heading=null,this.value=0,this.unit=null,this.description=null,this.centered=!1,this.centeredText=!1,this.vertical=!1,this.infoMessage=null,this.hideValueMargin=!1,this.isPercentUnit=!1,this.isUnit=!1}return Object.defineProperty(t.prototype,"hostClasses",{get:function(){return["metric-block",this.centered?"metric-block-centered":"",this.centeredText?"metric-block-centered-text":"",this.vertical?"metric-block-vertical":"",this.class].join(" ")},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){this.indicatorRef||(this.hideValueMargin=!0),"%"!==this.unit&&null!==this.unit?this.isUnit=!0:"%"===this.unit&&(this.isPercentUnit=!0)},t}();I.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-metric-block",template:'\n    <div class="metric-block-inner">\n      <div *ngIf="heading" class="metric-block-heading">\n        {{ heading }}\n        <i\n          *ngIf="infoMessage"\n          class="pbi-icon-mini pbi-info-circle-open ml-1 align-middle"\n          ngbTooltip="{{ infoMessage }}"\n          container="body"\n        ></i>\n      </div>\n      <div class="metric-block-data-block">\n        <div class="metric-block-contents">\n          <div class="metric-block-value" [ngClass]="{ \'mr-0\': hideValueMargin }">\n            {{ value\n            }}<span [ngClass]="{ \'metric-block-unit\': isUnit, \'metric-block-percentage\': isPercentUnit }">{{\n              unit\n            }}</span>\n          </div>\n\n          <div>\n            <ng-content select="pbds-dataviz-metric-indicator"></ng-content>\n          </div>\n          <div *ngIf="description" class="metric-block-description">{{ description }}</div>\n        </div>\n        <ng-content select="pbds-dataviz-sparkline"></ng-content>\n      </div>\n    </div>\n  '}]}],I.propDecorators={class:[{type:e.Input}],heading:[{type:e.Input}],value:[{type:e.Input}],unit:[{type:e.Input}],description:[{type:e.Input}],centered:[{type:e.Input}],centeredText:[{type:e.Input}],vertical:[{type:e.Input}],infoMessage:[{type:e.Input}],hostClasses:[{type:e.HostBinding,args:["class"]}],indicatorRef:[{type:e.ContentChild,args:[C,{static:!0}]}]};var L=function(){function t(t,i,a){var s=this;this._element=t,this._scroll=i,this._dataviz=a,this.chartClass=!0,this.bubbleMapClass=!0,this.feature="",this.scale=null,this.center=null,this.width=306,this.height=400,this.type="medium",this.dot=!1,this.marginTop=0,this.marginRight=0,this.marginBottom=0,this.marginLeft=0,this.color="#ef8200",this.textColor="#fff",this.textSizeRange=[14,24],this.dotSize=4,this.bubbleSizeRange=[500,2e3],this.bubbleLabelFormatType=null,this.bubbleLabelFormatString="",this.hideTooltip=!1,this.hideTooltipValue=!1,this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.updateChart=function(){s.bubbleContainer.selectAll("circle").data(s.data).join((function(t){return t.append("circle").attr("class","dot-circle").classed("solid",s.dot).attr("cx",(function(t){return s.projection([t.longitude,t.latitude])[0]})).attr("cy",(function(t){return s.projection([t.longitude,t.latitude])[1]})).attr("r",(function(t){return s.dot?s.dotSize+"px":Math.sqrt(s.bubbleRadius(t.value))}))}),(function(t){return t.transition().duration(1e3).attr("cx",(function(t){return s.projection([t.longitude,t.latitude])[0]})).attr("cy",(function(t){return s.projection([t.longitude,t.latitude])[1]})).attr("r",(function(t){return s.dot?s.dotSize+"px":Math.sqrt(s.bubbleRadius(t.value))})).transition().attr("pointer-events","auto")}),(function(t){return t.transition().attr("pointer-events","none").remove()})),s.hideTooltip||(s.bubbleContainer.selectAll("circle").on("mouseover",(function(t,e,i){return s.bubbleMouseOver(n.event,t,e,i)})).on("mouseout",(function(t,e,i){return s.bubbleMouseOut(n.event,t,e,i)})).on("click",(function(t,e,i){return s.bubbleMouseClick(n.event,t,e,i)})),"high"===s.type||s.dot||s.bubbleContainer.selectAll("text").data(s.data).join((function(t){return t.append("text").text((function(t){return s.bubbleLabelFormat?s.bubbleLabelFormat(t.value):t.value})).attr("class","dot-text").style("fill",s.textColor).style("font-size",(function(t){return Math.round(s.fontRange(t.value))+"px"})).attr("x",(function(t){return s.projection([t.longitude,t.latitude])[0]})).attr("y",(function(t){return s.projection([t.longitude,t.latitude])[1]})).attr("dy",".4em")}),(function(t){return t.attr("pointer-events","none").transition().duration(1e3).text((function(t){return s.bubbleLabelFormat?s.bubbleLabelFormat(t.value):t.value})).style("font-size",(function(t){return Math.round(s.fontRange(t.value))+"px"})).attr("x",(function(t){return s.projection([t.longitude,t.latitude])[0]})).attr("y",(function(t){return s.projection([t.longitude,t.latitude])[1]})).attr("dy",".4em").transition().attr("pointer-events","auto")}),(function(t){return t.transition().attr("pointer-events","none").remove()})))},this.bubbleMouseOver=function(t,e,i,a){s.chart.selectAll(".dot-circle").filter((function(t,e){return e!==i})).classed("inactive",!0),s.chart.selectAll(".dot-circle").filter((function(t,e){return e===i})).classed("active",!0),s.tooltipShow(e,a[i]),s.hovered.emit({event:t,data:e})},this.bubbleMouseOut=function(t,e,i,a){s.chart.selectAll(".dot-circle").classed("active",!1).classed("inactive",!1),s.tooltipHide()},this.bubbleMouseClick=function(t,e,i,a){s.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e){var i=e.getBoundingClientRect(),a=s._scroll.getScrollPosition();s.tooltip.select(".tooltip-header").html((function(e){return""+t.label})),s.hideTooltipValue||s.tooltip.select(".tooltip-value").html((function(e){return s.tooltipValueFormat?""+s.tooltipValueFormat(t.value):""+t.value}));var n=+s.tooltip.node().offsetWidth/2,r=+s.tooltip.node().offsetHeight+8;s.tooltip.style("top",+a[1]+ +i.top-r+"px"),s.tooltip.style("left",+a[0]+ +i.left-n+ +i.width/2+"px"),s.tooltip.style("opacity",1)},this.tooltipHide=function(){s.tooltip.style("opacity",0)}}return t.prototype.ngOnInit=function(){var t=this;switch(this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},"debug"!==this.type&&this.type,this.projectionType){case"geoAlbers":this.projection=g.geoAlbers();break;case"geoAlbersUsa":this.projection=g.geoAlbersUsa();break;case"geoMercator":this.projection=g.geoMercator()}this.bubbleLabelFormat=this._dataviz.d3Format(this.bubbleLabelFormatType,this.bubbleLabelFormatString),this.tooltipValueFormat=this._dataviz.d3Format(this.tooltipValueFormatType,this.tooltipValueFormatString),this.topojsonFeature=m.feature(this.topojson,this.topojson.objects[this.feature]),this.projection.fitSize([+this.width,+this.height],this.topojsonFeature),this.scale&&this.projection.scale(+this.scale),this.center&&this.projection.center(this.center),this.geoPath=g.geoPath().projection(this.projection),this.data&&!this.dot&&(this.bubbleRadius=s.scaleLinear().range(this.bubbleSizeRange).domain([d.min(this.data,(function(t){return+t.value})),d.max(this.data,(function(t){return+t.value}))]),this.fontRange=s.scaleLinear().range(this.textSizeRange).domain([d.min(this.data,(function(t){return+t.value})),d.max(this.data,(function(t){return+t.value}))])),this.hideTooltip||(this.tooltip=n.select("body").append("div").attr("class","pbds-tooltip south").style("opacity",0).attr("aria-hidden","true"),this.tooltip.append("div").attr("class","tooltip-header"),this.hideTooltipValue||this.tooltip.append("div").attr("class","tooltip-value")),this.chart=n.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",+this.width+this.margin.left+this.margin.right).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+(+this.width+this.margin.left+this.margin.right)+" "+(+this.height+this.margin.top+this.margin.bottom)).append("g").attr("class","container"),this.svg.append("g").attr("class","map").selectAll("path").data(this.topojsonFeature.features).join((function(e){return e.append("path").attr("class","feature").attr("d",t.geoPath)})),this.svg.append("path").attr("class","mesh").datum(m.mesh(this.topojson,this.topojson.objects[this.feature],(function(t,e){return t!==e}))).attr("d",this.geoPath),this.bubbleContainer=this.svg.append("g").attr("class","dots").style("color",this.color),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t}();L.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-bubble-map",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],L.ctorParameters=function(){return[{type:e.ElementRef},{type:i.ViewportScroller},{type:v}]},L.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],bubbleMapClass:[{type:e.HostBinding,args:["class.pbds-chart-bubble-map"]}],data:[{type:e.Input}],topojson:[{type:e.Input}],feature:[{type:e.Input}],projectionType:[{type:e.Input}],scale:[{type:e.Input}],center:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],type:[{type:e.Input}],dot:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],color:[{type:e.Input}],textColor:[{type:e.Input}],textSizeRange:[{type:e.Input}],dotSize:[{type:e.Input}],bubbleSizeRange:[{type:e.Input}],bubbleLabelFormatType:[{type:e.Input}],bubbleLabelFormatString:[{type:e.Input}],hideTooltip:[{type:e.Input}],hideTooltipValue:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var D=function(t,e){return(D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};Object.create;function M(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var a,n,s=i.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(a=s.next()).done;)r.push(a.value)}catch(t){n={error:t}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return r}function O(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(M(arguments[e]));return t}Object.create;var B=function(){function t(t,i,a){var s=this;this._dataviz=t,this._element=i,this._scroll=a,this.chartClass=!0,this.heatmapClass=!0,this.width=306,this.height=400,this.marginTop=0,this.marginRight=0,this.marginBottom=30,this.marginLeft=55,this.scale="quantile",this.xAxisFormatType=null,this.xAxisFormatString="",this.yAxisFormatType=null,this.yAxisFormatString="",this.hideLegend=!1,this.legendWidth=133,this.legendPosition="right",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.tooltipXLabelFormatType=null,this.tooltipXLabelFormatString="",this.tooltipYLabelFormatType=null,this.tooltipYLabelFormatString="",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.theme="classic",this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.updateChart=function(){s.svg.selectAll("rect").data(s.data).join((function(t){return t.append("rect").attr("class","block").classed("empty",(function(t){return void 0===t.value||null===t.value})).attr("x",(function(t){return s.xAxisScale(t.xLabel)})).attr("y",(function(t){return s.yAxisScale(t.yLabel)})).attr("width",s.xAxisScale.bandwidth()).attr("height",s.yAxisScale.bandwidth()).style("fill",(function(t){return s.colorRange(t.value)}))}),(function(t){return t.call((function(t){return t.classed("empty",(function(t){return void 0===t.value||null===t.value})).attr("pointer-events","none").transition().duration(1e3).attr("x",(function(t){return s.xAxisScale(t.xLabel)})).attr("y",(function(t){return s.yAxisScale(t.yLabel)})).attr("width",s.xAxisScale.bandwidth()).attr("height",s.yAxisScale.bandwidth()).style("fill",(function(t){return s.colorRange(t.value)})).transition().attr("pointer-events","auto"),t}))}),(function(t){return t.transition().attr("pointer-events","none").remove()})).on("mouseover",(function(t,e,i){return s.blockMouseOver(n.event,t,e,i)})).on("mouseout",(function(t,e,i){return s.blockMouseOut()})).on("click",(function(t,e,i){return s.blockMouseClick(n.event,t,e,i)})),s.hideLegend||s.chart.select(".legend").selectAll(".legend-item").data(s.colorDomain).join((function(t){var e=t.append("li").attr("class","legend-item");return e.append("span").attr("class","legend-key").style("background-color",(function(t){return s.colorRange(t)})),e.append("span").attr("class","legend-label").html((function(t){var e=t;switch(s.legendLabelFormatType){case"number":e=s.legendLabelFormat(t)}return"&ge; "+e})),e}),(function(t){return t.select(".legend-label").html((function(t){var e=t;switch(s.legendLabelFormatType){case"number":e=s.legendLabelFormat(t)}return"&ge; "+e}))}),(function(t){return t.remove()})).on("mouseover",(function(t,e,i){return s.legendMouseOver(n.event,t,e,i)})).on("mouseout",(function(){return s.legendMouseOut()})).on("click",(function(t,e,i){return s.legendMouseClick(n.event,t,e,i)}))},this.blockMouseOver=function(t,e,i,a){null!==e.value&&s.tooltipShow(e,i,a[i]),s.hovered.emit({event:t,data:e})},this.blockMouseOut=function(){s.tooltipHide()},this.blockMouseClick=function(t,e,i,a){s.clicked.emit({event:t,data:e})},this.legendMouseOver=function(t,e,i,a){s.chart.selectAll(".legend-item").filter((function(t,e){return e!==i})).classed("inactive",!0),s.chart.selectAll(".block").filter((function(t,s){return i+1===a.length?t.value<e:t.value<e||t.value>=+n.select(a[i+1]).data()[0]})).classed("inactive",!0),s.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){s.chart.selectAll(".legend-item").classed("inactive",!1),s.chart.selectAll(".block").classed("inactive",!1)},this.legendMouseClick=function(t,e,i,a){s.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e,i){var a,n,r=i.getBoundingClientRect(),o=s._scroll.getScrollPosition();switch(s.tooltipYLabelFormatType){case"number":a=s.tooltipYLabelFormat(t.yLabel);break;case"time":var l=h.isoParse(t.yLabel);a=s.tooltipYLabelFormat(l);break;default:a=""+t.yLabel+s.tooltipYLabelFormatString}switch(s.tooltipXLabelFormatType){case"number":n=s.tooltipXLabelFormat(t.xLabel);break;case"time":l=h.isoParse(t.xLabel);n=s.tooltipXLabelFormat(l);break;default:n=""+t.xLabel+s.tooltipXLabelFormatString}var c=null===s.tooltipValueFormat?'<div class="tooltip-value">'+t.value+"</div>":'<div class="tooltip-value">'+s.tooltipValueFormat(t.value)+"</div>";s.tooltip.html("\n        "+a+" : "+n+"<br>\n        "+c+"\n      ");var d=+s.tooltip.node().offsetWidth/2,u=+s.tooltip.node().offsetHeight+8;s.tooltip.style("top",+o[1]+ +r.top-u+"px"),s.tooltip.style("left",+o[0]+ +r.left-d+ +r.width/2+"px"),s.tooltip.style("opacity",1),s.tooltip.style("opacity",1)},this.tooltipHide=function(){s.tooltip.style("opacity",0)},this.xAxisFormatter=function(t){switch(s.xAxisFormatType){case"number":return s.xAxisFormat(t);case"time":var e=h.isoParse(t);return s.xAxisFormat(e);default:return t}},this.yAxisFormatter=function(t){switch(s.yAxisFormatType){case"number":return s.yAxisFormat(t);case"time":var e=h.isoParse(t);return s.yAxisFormat(e);default:return t}}}return t.prototype.ngOnInit=function(){this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.yAxisFormat=this._dataviz.d3Format(this.yAxisFormatType,this.yAxisFormatString),this.xAxisFormat=this._dataviz.d3Format(this.xAxisFormatType,this.xAxisFormatString),this.legendLabelFormat=this._dataviz.d3Format(this.legendLabelFormatType,this.legendLabelFormatString),this.tooltipYLabelFormat=this._dataviz.d3Format(this.tooltipYLabelFormatType,this.tooltipYLabelFormatString),this.tooltipXLabelFormat=this._dataviz.d3Format(this.tooltipXLabelFormatType,this.tooltipXLabelFormatString),this.tooltipValueFormat=this._dataviz.d3Format(this.tooltipValueFormatType,this.tooltipValueFormatString),this.hideXAxis=!1,this.hideXAxisZero=!1,this.hideXAxisDomain=!0,this.hideYAxisDomain=!0,this.hideTooltip=!1,this.hideXAxisTicks=!0,this.hideYAxisTicks=!0,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.yAxisTickSize=8,this.yAxisTickSizeOuter=0,this.chart=n.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",+this.width).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+ +this.width+" "+(+this.height+this.margin.top+this.margin.bottom));var t=this._dataviz.getColors(!0,this.theme).slice().reverse(),e=[+d.min(this.data,(function(t){return t.value})),+d.max(this.data,(function(t){return t.value}))],i=this.data.map((function(t){return t.value}));switch(this.scale){case"threshold":this.colorRange=s.scaleThreshold().domain(this.domain).range(t),this.colorDomain=this.colorRange.domain();break;case"quantile":this.colorRange=s.scaleQuantile().domain(i).range(t),this.colorDomain=this.colorRange.quantiles();break;case"quantize":this.colorRange=s.scaleQuantize().domain(e).range(t),this.colorDomain=this.colorRange.thresholds()}var a=O(new Set(this.data.map((function(t){return t.xLabel})))),r=O(new Set(this.data.map((function(t){return t.yLabel})))).reverse();this.xAxisScale=s.scaleBand().domain(a).rangeRound([0,this.width-this.margin.left]).paddingInner(.1),this.xAxisCall=u.axisBottom(this.xAxisScale).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.yAxisScale=s.scaleBand().domain(r).rangeRound([this.height,0]).paddingInner(.1),this.yAxisCall=u.axisLeft(this.yAxisScale).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.hideTooltip||(this.tooltip=n.select("body").append("div").attr("class","pbds-tooltip south").style("opacity",0).attr("aria-hidden","true")),this.hideLegend||(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t}();B.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-heatmap",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],B.ctorParameters=function(){return[{type:v},{type:e.ElementRef},{type:i.ViewportScroller}]},B.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],heatmapClass:[{type:e.HostBinding,args:["class.pbds-chart-heatmap"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],scale:[{type:e.Input}],domain:[{type:e.Input}],xAxisFormatType:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],yAxisFormatType:[{type:e.Input}],yAxisFormatString:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],tooltipXLabelFormatType:[{type:e.Input}],tooltipXLabelFormatString:[{type:e.Input}],tooltipYLabelFormatType:[{type:e.Input}],tooltipYLabelFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]};var z=function(){function t(t,i,a){var r=this;this._dataviz=t,this._element=i,this._scroll=a,this.chartClass=!0,this.choroplethMapClass=!0,this.feature="",this.dataField="id",this.mesh=null,this.scale=null,this.center=null,this.width=960,this.height=500,this.marginTop=0,this.marginRight=0,this.marginBottom=0,this.marginLeft=0,this.theme="classic",this.colorScale="quantile",this.hideTooltip=!1,this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.hideLegend=!1,this.legendWidth=260,this.legendLabel=null,this.legendValueFormatType=null,this.legendValueFormatString="",this.legendLeft=20,this.legendTop=20,this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.updateChart=function(){r.svg.select(".map").selectAll("path").style("fill",(function(t,e){var i=r.data.find((function(e){return e[r.dataField]===t[r.dataField]}));if(i)return r.colorRange(i.value)})).classed("hasData",(function(t,e){return r.data.some((function(e){return e[r.dataField]===t[r.dataField]}))})),r.hideTooltip||r.svg.select(".map").selectAll("path").on("mouseover",(function(t,e,i){return r.featureMouseOver(n.event,r.data.find((function(e){return e[r.dataField]===t[r.dataField]})),e,i)})).on("mouseout",(function(t,e,i){return r.featureMouseOut(n.event,r.data,e,i)})).on("mousemove",(function(t,e,i){return r.tooltipMove(r.chart.node())})).on("click",(function(t,e,i){return r.featureMouseClick(n.event,r.data.find((function(e){return e[r.dataField]===t[r.dataField]})),e,i)}))},this.featureMouseOver=function(t,e,i,a){e&&(r.tooltipShow(e,a[i]),r.hovered.emit({event:t,data:e}))},this.featureMouseOut=function(t,e,i,a){r.tooltipHide()},this.featureMouseClick=function(t,e,i,a){e&&r.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e){r.tooltipSetPosition(e),t.label&&r.tooltip.select(".tooltip-header").html((function(e){return""+t.label})),r.tooltip.select(".tooltip-value").html((function(e){return r.tooltipValueFormat?""+r.tooltipValueFormat(t.value):""+t.value})),r.tooltip.style("opacity",1)},this.tooltipHide=function(){r.tooltip.style("opacity",0)},this.tooltipMove=function(t){r.tooltipSetPosition(t)},this.tooltipSetPosition=function(t){var e=n.mouse(t),i=+e[0],a=+e[1],s=t.getBoundingClientRect(),o=+s.left,l=+s.top,h=+r._scroll.getScrollPosition()[1],c=+r.tooltip.node().offsetWidth/2,d=+r.tooltip.node().offsetHeight;r.tooltip.style("top",h+a+l-d-14+"px"),r.tooltip.style("left",i+o-c+"px")},this.legend=function(t){var e=r.colorRange.range().length,i=s.scaleLinear().domain([1,e-1]).rangeRound([+r.legendWidth/e,r.legendWidth*(e-1)/e]);t.attr("class","legend").selectAll("rect").data(r.colorRange.range()).join("rect").attr("height",8).attr("x",(function(t,e){return i(e)})).attr("width",(function(t,e){return i(e+1)-i(e)})).attr("fill",(function(t){return t})),r.legendLabel&&t.append("text").attr("y",-6).attr("text-anchor","start").attr("class","legend-label").text(r.legendLabel),t.call(u.axisBottom(i).tickSize(13).tickValues(d.range(1,e)).tickFormat((function(t){return r.legendValueFormat?""+r.legendValueFormat(r.colorDomain[t-1]):""+r.colorDomain[t-1]}))).select(".domain").remove()}}return t.prototype.ngOnInit=function(){var t=this;this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft};var e=this._dataviz.getColors(!0,this.theme).slice().reverse(),i=[+d.min(this.data,(function(t){return t.value})),+d.max(this.data,(function(t){return t.value}))],a=this.data.map((function(t){return t.value}));switch(this.colorScale){case"threshold":this.colorRange=s.scaleThreshold().domain(this.domain).range(e),this.colorDomain=this.colorRange.domain();break;case"quantile":this.colorRange=s.scaleQuantile().domain(a).range(e),this.colorDomain=this.colorRange.quantiles();break;case"quantize":this.colorRange=s.scaleQuantize().domain(i).range(e),this.colorDomain=this.colorRange.thresholds()}switch(this.tooltipValueFormat=this._dataviz.d3Format(this.tooltipValueFormatType,this.tooltipValueFormatString),this.legendValueFormat=this._dataviz.d3Format(this.legendValueFormatType,this.legendValueFormatString),this.projectionType){case"geoAlbers":this.projection=g.geoAlbers();break;case"geoAlbersUsa":this.projection=g.geoAlbersUsa();break;case"geoMercator":this.projection=g.geoMercator()}this.topojsonFeature=m.feature(this.topojson,this.topojson.objects[this.feature]),this.projection.fitSize([+this.width,+this.height],this.topojsonFeature),this.scale&&this.projection.scale(+this.scale),this.center&&this.projection.center(this.center),this.geoPath=g.geoPath().projection(this.projection),this.chart=n.select(this._element.nativeElement).attr("aria-hidden","true"),this.hideTooltip||(this.tooltip=n.select("body").append("div").attr("class","pbds-tooltip south").style("opacity",0).attr("aria-hidden","true"),this.tooltip.append("div").attr("class","tooltip-header"),this.tooltip.append("div").attr("class","tooltip-value")),this.svg=this.chart.append("svg").attr("width",+this.width).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","-"+this.margin.left+" -"+this.margin.top+" "+ +this.width+" "+(+this.height+this.margin.top+this.margin.bottom)),this.svg.append("g").attr("class","map").selectAll("path").data(this.topojsonFeature.features).join((function(e){return e.append("path").attr("class","feature").attr("d",t.geoPath)})),this.svg.append("path").attr("class","mesh").datum(m.mesh(this.topojson,this.topojson.objects[this.mesh||this.feature],(function(t,e){return t!==e}))).attr("d",this.geoPath),this.hideLegend||this.svg.append("g").attr("transform","translate("+ +this.legendLeft+", "+ +this.legendTop+")").call(this.legend),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t}();z.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-choropleth-map",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],z.ctorParameters=function(){return[{type:v},{type:e.ElementRef},{type:i.ViewportScroller}]},z.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],choroplethMapClass:[{type:e.HostBinding,args:["class.pbds-chart-choropleth-map"]}],data:[{type:e.Input}],topojson:[{type:e.Input}],feature:[{type:e.Input}],projectionType:[{type:e.Input}],dataField:[{type:e.Input}],mesh:[{type:e.Input}],scale:[{type:e.Input}],center:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],theme:[{type:e.Input}],colorScale:[{type:e.Input}],domain:[{type:e.Input}],hideTooltip:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendLabel:[{type:e.Input}],legendValueFormatType:[{type:e.Input}],legendValueFormatString:[{type:e.Input}],legendLeft:[{type:e.Input}],legendTop:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]};var R=function(){function t(t,i,a,s){var r=this;this._dataviz=t,this._element=i,this._scroll=a,this._location=s,this.chartClass=!0,this.groupedBarClass=!0,this.width=306,this.height=400,this.vertical=!0,this.hideXAxis=!1,this.xAxisMaxBuffer=.01,this.xAxisFormatType=null,this.xAxisFormatString="",this.xAxisTicks=5,this.hideYAxis=!1,this.yAxisMaxBuffer=.01,this.yAxisFormatType=null,this.yAxisFormatString="",this.yAxisTicks=5,this.marginTop=10,this.marginRight=this.vertical?0:55,this.marginBottom=30,this.marginLeft=55,this.hideLegend=!1,this.legendWidth=133,this.legendPosition="right",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.hideTooltip=!1,this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.showGrid=!1,this.theme="classic",this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.barMouseOver=function(t,e,i,a){var s=n.select(a[i]);r.chart.selectAll(".bar-group").selectAll(".bar").classed("inactive",!0),s.classed("inactive",!1).style("fill",s.attr("data-color")),r.tooltipShow(e,a[i]),r.hovered.emit({event:t,data:e})},this.barMouseOut=function(){r.chart.selectAll(".bar").classed("inactive",!1).style("fill",null),r.tooltipHide()},this.barMouseClick=function(t,e,i,a){r.clicked.emit({event:t,data:e})},this.legendMouseOver=function(t,e,i,a){r.chart.selectAll(".legend-item").filter((function(t,e){return e!==i})).classed("inactive",!0),r.chart.selectAll(".bar-group").selectAll(".bar").filter((function(t,e){return e!==i})).classed("inactive",!0);var n=r.chart.selectAll(".bar-group").selectAll(".bar").filter((function(t,e){return e===i})).classed("inactive",null),s=n.attr("data-color");n.style("fill",(function(){return s})),r.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){r.chart.selectAll(".legend-item").classed("inactive",!1),r.chart.selectAll(".bar-group").selectAll(".bar").classed("inactive",!1).style("fill",null)},this.legendMouseClick=function(t,e,i,a){r.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e){var i,a=e.getBoundingClientRect(),n=r._scroll.getScrollPosition();switch(r.tooltipLabelFormatType){case"number":i=r.tooltipLabelFormat(t.label);break;case"time":var s=h.isoParse(t.label);i=r.tooltipLabelFormat(s);break;default:i=t.label}var o=null===r.tooltipValueFormat?'<div class="tooltip-value">'+t.value+"</div>":'<div class="tooltip-value">'+r.tooltipValueFormat(t.value)+"</div>";r.tooltip.html("\n        "+i+"\n        "+o+"\n      ");var l=+r.tooltip.node().offsetWidth/2,c=+r.tooltip.node().offsetHeight;r.vertical?(r.tooltip.style("top",+n[1]+ +a.top-c-8+"px"),r.tooltip.style("left",+n[0]+ +a.left-l+ +a.width/2+"px")):(r.tooltip.style("top",+n[1]+ +a.top+ +a.height/2-c/2+"px"),r.tooltip.style("left",+n[0]+ +a.right+8+"px")),r.tooltip.style("opacity",1)},this.tooltipHide=function(){r.tooltip.style("opacity",0)},this.xAxisFormatter=function(t){switch(r.xAxisFormatType){case"number":return r.xAxisFormat(t);case"time":var e=h.isoParse(t);return r.xAxisFormat(e);default:return t}},this.yAxisFormatter=function(t){switch(r.yAxisFormatType){case"number":return r.yAxisFormat(t);case"time":var e=h.isoParse(t);return r.yAxisFormat(e);default:return t}}}return t.prototype.ngOnInit=function(){var t=this;this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.xAxisFormat=this._dataviz.d3Format(this.xAxisFormatType,this.xAxisFormatString),this.yAxisFormat=this._dataviz.d3Format(this.yAxisFormatType,this.yAxisFormatString),this.legendLabelFormat=this._dataviz.d3Format(this.legendLabelFormatType,this.legendLabelFormatString),this.tooltipLabelFormat=this._dataviz.d3Format(this.tooltipLabelFormatType,this.tooltipLabelFormatString),this.tooltipValueFormat=this._dataviz.d3Format(this.tooltipValueFormatType,this.tooltipValueFormatString),this.hideGrayBars=!1,this.hideXAxisZero=!1,this.hideXAxisDomain=!1,this.hideXAxisTicks=!0,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.hideYAxisZero=!1,this.hideYAxisDomain=!1,this.hideYAxisTicks=!0,this.yAxisTickSize=8,this.yAxisTickSizeOuter=0,this.hideLegend||"right"!==this.legendPosition||(this.width=+this.width-+this.legendWidth),this.chart=n.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",(function(){return t.vertical?+t.width:+t.width+t.margin.left+t.margin.right})).attr("height",+this.height+this.margin.top+this.margin.bottom).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",(function(){return t.vertical?"-"+t.margin.left+" -"+t.margin.top+" "+ +t.width+" "+(+t.height+t.margin.top+t.margin.bottom):"-"+t.margin.left+" -"+t.margin.top+" "+(+t.width+t.margin.left+t.margin.right)+" "+(+t.height+t.margin.top+t.margin.bottom)})),this.hideTooltip||(this.tooltip=n.select("body").append("div").attr("class",(function(){return t.vertical?"pbds-tooltip south":"pbds-tooltip west"})).style("opacity",0).attr("aria-hidden","true")),this.hideLegend||(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.colorRange=s.scaleOrdinal().range(this._dataviz.createGradientDefs(this.svg,!1,this.theme,this.vertical)),this.vertical?(this.xAxisScale=s.scaleBand().domain(this.data.map((function(t){return t.key}))).rangeRound([0,this.width-this.margin.left]).align(0),this.hideGrayBars?this.xAxisScale.paddingInner(0).paddingOuter(0):this.xAxisScale.paddingInner(.1).paddingOuter(0),this.xAxisCall=u.axisBottom(this.xAxisScale).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.yAxisMax=d.max(this.data,(function(t){var e=Object.assign({},t);return delete e.key,d.max(f.values(e))})),this.yAxisMax=this.yAxisMax+this.yAxisMax*this.yAxisMaxBuffer,this.yAxisScale=s.scaleLinear().domain([0,this.yAxisMax]).nice().rangeRound([this.height,0]),this.yAxisCall=u.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.showGrid&&(this.yGridCall=u.axisLeft(this.yAxisScale).ticks(this.yAxisTicks).tickSize(-this.width+this.margin.left+this.margin.right),this.yGrid=this.svg.append("g").attr("class","grid grid-y").classed("grid-zero-hidden",this.hideYAxisZero).attr("transform","translate(0, 0)").call(this.yGridCall)),this.barScale=s.scaleBand().domain(Object.keys(this.data[0]).slice(1)).rangeRound([0,this.xAxisScale.bandwidth()]).paddingInner(.2).paddingOuter(.5),this.updateChartVertical()):(this.xAxisMax=d.max(this.data,(function(t){var e=Object.assign({},t);return delete e.key,d.max(f.values(e))})),this.xAxisMax=this.xAxisMax+this.xAxisMax*this.xAxisMaxBuffer,this.xAxisScale=s.scaleLinear().domain([0,this.xAxisMax]).rangeRound([0,this.width]).nice(),this.xAxisCall=u.axisBottom(this.xAxisScale).ticks(this.xAxisTicks).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks).call(this.xAxisCall),this.yAxisScale=s.scaleBand().domain(this.data.map((function(t){return t.key}))).rangeRound([0,this.height]).align(1),this.hideGrayBars?this.yAxisScale.paddingInner(0).paddingOuter(0):this.yAxisScale.paddingInner(.1).paddingOuter(0),this.yAxisCall=u.axisLeft(this.yAxisScale).tickSize(this.yAxisTickSize).tickSizeOuter(this.yAxisTickSizeOuter).tickFormat(this.yAxisFormatter),this.yAxis=this.svg.append("g").attr("class","axis axis-y").classed("axis-hidden",this.hideYAxis).classed("axis-zero-hidden",this.hideYAxisZero).classed("axis-domain-hidden",this.hideYAxisDomain).classed("axis-ticks-hidden",this.hideYAxisTicks).call(this.yAxisCall),this.showGrid&&(this.xGridCall=u.axisBottom(this.xAxisScale).tickSize(-this.height),this.xGrid=this.svg.append("g").attr("class","grid grid-x").classed("grid-zero-hidden",this.hideXAxisZero).attr("transform","translate(0, "+this.height+")").call(this.xGridCall)),this.barScale=s.scaleBand().domain(Object.keys(this.data[0]).slice(1)).rangeRound([this.yAxisScale.bandwidth(),0]).paddingInner(.2).paddingOuter(.5),this.updateChartHorizontal())},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&(this.vertical?this.updateChartVertical():this.updateChartHorizontal())},t.prototype.updateChartVertical=function(){var t=this;this.xAxisScale.domain(this.data.map((function(t){return t.key}))),this.yAxisMax=d.max(this.data,(function(t){var e=Object.assign({},t);return delete e.key,d.max(f.values(e))})),this.yAxisMax=this.yAxisMax+this.yAxisMax*this.yAxisMaxBuffer,this.yAxisScale.domain([0,this.yAxisMax]).rangeRound([this.height,0]).nice(),this.xAxis.transition().duration(1e3).call(this.xAxisCall),this.yAxis.transition().duration(1e3).call(this.yAxisCall),this.showGrid&&this.yGrid.transition().duration(1e3).call(this.yGridCall),this.barScale.domain(Object.keys(this.data[0]).slice(1)).rangeRound([0,this.xAxisScale.bandwidth()]),this.svg.selectAll(".gray-bar").data(this.data).join((function(e){return e.append("rect").attr("class","gray-bar").attr("x",(function(e){return t.xAxisScale(e.key)})).attr("y",(function(e){return t.yAxisScale(e.value)})).attr("width",t.xAxisScale.bandwidth()).attr("height",t.height)}),(function(e){return e.transition().duration(1e3).attr("x",(function(e){return t.xAxisScale(e.key)})).attr("y",(function(e){return t.yAxisScale(e.value)})).attr("width",t.xAxisScale.bandwidth()).attr("height",t.height)})),this.svg.selectAll(".bar-group").data(this.data).join((function(e){return e.append("g").attr("class","bar-group").attr("transform",(function(e,i){return"translate("+t.xAxisScale(e.key)+", 0)"}))}),(function(e){return e.transition().duration(1e3).attr("transform",(function(e,i){return"translate("+t.xAxisScale(e.key)+", 0)"}))})),this.svg.selectAll(".bar-group").selectAll(".bar").data((function(t,e){var i=Object.assign({},t);return delete i.key,Object.keys(i).map((function(i){return{label:i,value:t[i],parentIndex:e}}))})).join((function(e){return e.append("rect").attr("class","bar").attr("fill",(function(e){return"url("+t._location.path()+"#gradient-"+t.colorRange(e.label).substr(1)+")"})).attr("data-color",(function(e){return t.colorRange(e.label)})).attr("data-parent-index",(function(t){return t.parentIndex})).attr("x",(function(e){return t.barScale(e.label)})).attr("width",t.barScale.bandwidth()).attr("y",t.height).attr("height",0).call((function(e){return e.attr("pointer-events","none").transition().duration(0).attr("height",(function(e){return t.height-t.yAxisScale(e.value)})).attr("y",(function(e){return t.yAxisScale(e.value)})).transition().attr("pointer-events","auto")}))}),(function(e){return e.attr("pointer-events","none").transition().duration(1e3).attr("x",(function(e){return t.barScale(e.label)})).attr("width",t.barScale.bandwidth()).attr("height",(function(e){return t.height-t.yAxisScale(e.value)})).attr("y",(function(e){return t.yAxisScale(e.value)})).transition().attr("pointer-events","auto")}),(function(e){return e.transition().duration(0).attr("pointer-events","none").attr("height",0).attr("y",t.height)})).on("mouseover",(function(e,i,a){return t.barMouseOver(n.event,e,i,a)})).on("mouseout",(function(e,i,a){return t.barMouseOut()})).on("click",(function(e,i,a){return t.barMouseClick(n.event,e,i,a)})),this.updateLegend(),this.svg.selectAll(".axis").raise()},t.prototype.updateChartHorizontal=function(){var t=this;this.xAxisMax=d.max(this.data,(function(t){var e=Object.assign({},t);return delete e.key,d.max(f.values(e))})),this.xAxisMax=this.xAxisMax+this.xAxisMax*this.xAxisMaxBuffer,this.xAxisScale.domain([0,this.xAxisMax]).rangeRound([0,this.width]).nice(),this.yAxisScale.domain(this.data.map((function(t){return t.key}))),this.xAxis.transition().duration(1e3).call(this.xAxisCall),this.yAxis.transition().duration(1e3).call(this.yAxisCall),this.showGrid&&this.xGrid.transition().duration(1e3).call(this.xGridCall),this.barScale.domain(Object.keys(this.data[0]).slice(1)).rangeRound([0,this.yAxisScale.bandwidth()]),this.svg.selectAll(".gray-bar").data(this.data).join((function(e){return e.append("rect").attr("class","gray-bar").attr("y",(function(e){return t.yAxisScale(e.key)})).attr("width",t.width).attr("height",t.yAxisScale.bandwidth())}),(function(e){return e.transition().duration(1e3).attr("y",(function(e){return t.yAxisScale(e.key)})).attr("width",t.width).attr("height",t.yAxisScale.bandwidth())})),this.svg.selectAll(".bar-group").data(this.data).join((function(e){return e.append("g").attr("class","bar-group").attr("transform",(function(e,i){return"translate(0, "+t.yAxisScale(e.key)+")"}))}),(function(e){return e.transition().duration(1e3).attr("transform",(function(e,i){return"translate(0, "+t.yAxisScale(e.key)+")"}))})),this.svg.selectAll(".bar-group").selectAll(".bar").data((function(t,e){var i=Object.assign({},t);return delete i.key,Object.keys(i).map((function(i){return{label:i,value:t[i],parentIndex:e}}))})).join((function(e){return e.append("rect").attr("class","bar").attr("fill",(function(e){return"url("+t._location.path()+"#gradient-horizontal-"+t.colorRange(e.label).substr(1)+")"})).attr("data-color",(function(e){return t.colorRange(e.label)})).attr("data-parent-index",(function(t){return t.parentIndex})).attr("x",0).attr("width",0).attr("y",(function(e){return t.barScale(e.label)})).attr("height",t.barScale.bandwidth()).call((function(e){return e.attr("pointer-events","none").transition().duration(0).attr("width",(function(e){return t.xAxisScale(e.value)})).transition().attr("pointer-events","auto")}))}),(function(e){return e.attr("pointer-events","none").transition().duration(1e3).attr("width",(function(e){return t.xAxisScale(e.value)})).attr("height",t.barScale.bandwidth()).attr("y",(function(e){return t.barScale(e.label)})).transition().attr("pointer-events","auto")}),(function(t){return t.transition().duration(0).attr("pointer-events","none").attr("width",0)})).on("mouseover",(function(e,i,a){return t.barMouseOver(n.event,e,i,a)})).on("mouseout",(function(e,i,a){return t.barMouseOut()})).on("click",(function(e,i,a){return t.barMouseClick(n.event,e,i,a)})),this.updateLegend(),this.svg.selectAll(".axis").raise()},t.prototype.updateLegend=function(){var t=this;if(!this.hideLegend){var e=Object.assign({},this.data[0]);delete e.key;var i=Object.keys(e).map((function(t){return{label:t}}));this.chart.select(".legend").selectAll(".legend-item").data(i).join((function(e){var i=e.append("li").attr("class","legend-item");return i.insert("span").attr("class","legend-key").style("background-color",(function(e){return t.colorRange(e.label)})),i.insert("span",".legend-item").attr("class","legend-label").html((function(e){switch(t.legendLabelFormatType){case"number":return t.legendLabelFormat(e.label);case"time":var i=h.isoParse(e.label);return t.legendLabelFormat(i);default:return e.label}})),i}),(function(e){return e.select(".legend-label").html((function(e){switch(t.legendLabelFormatType){case"number":return t.legendLabelFormat(e.label);case"time":var i=h.isoParse(e.label);return t.legendLabelFormat(i);default:return e.label}})),e}),(function(t){return t.remove()})).on("mouseover",(function(e,i,a){return t.legendMouseOver(n.event,e,i,a)})).on("mouseout",(function(){return t.legendMouseOut()})).on("click",(function(e,i,a){return t.legendMouseClick(n.event,e,i,a)}))}},t}();R.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-bar-grouped",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],R.ctorParameters=function(){return[{type:v},{type:e.ElementRef},{type:i.ViewportScroller},{type:i.Location}]},R.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],groupedBarClass:[{type:e.HostBinding,args:["class.pbds-chart-bar-grouped"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],vertical:[{type:e.Input}],hideXAxis:[{type:e.Input}],xAxisMaxBuffer:[{type:e.Input}],xAxisFormatType:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],xAxisTicks:[{type:e.Input}],hideYAxis:[{type:e.Input}],yAxisMaxBuffer:[{type:e.Input}],yAxisFormatType:[{type:e.Input}],yAxisFormatString:[{type:e.Input}],yAxisTicks:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],hideLegend:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],hideTooltip:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],showGrid:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]};var P=function(){function t(t,i,a,s){var r=this;this._dataviz=t,this._element=i,this._scroll=a,this._location=s,this.chartClass=!0,this.singleStackedBarClass=!0,this.width=300,this.height=40,this.nullValueText="No data available",this.percentage=!1,this.marginTop=10,this.marginRight=20,this.marginBottom=35,this.marginLeft=15,this.barMargin=2,this.hideXAxis=!1,this.xAxisTicks=6,this.xAxisTitle=null,this.xAxisFormatType=null,this.xAxisFormatString="",this.xAxisTickLabelSuffix="",this.hideXGrid=!1,this.hideLegend=!1,this.hideLegendTooltip=!0,this.legendWidth=133,this.legendPosition="bottom",this.legendLabelFormatType=null,this.legendLabelFormatString="",this.hideTooltip=!1,this.tooltipLabelFormatType=null,this.tooltipLabelFormatString="",this.tooltipDateFormatString="%b %e, %Y",this.tooltipValueFormatType=null,this.tooltipValueFormatString="",this.tooltipValueSuffix="",this.tooltipPercentFormatString=".2%",this.compareChangeFormatString=".2%",this.monochrome=!1,this.hovered=new e.EventEmitter,this.clicked=new e.EventEmitter,this.isSingleData=!1,this.isCompare=!1,this.barPadding=40,this.barMouseOver=function(t,e,i,a){var s=n.select(a[i]);r.chart.selectAll(".bar").classed("inactive",!0),s.classed("inactive",!1),r.chart.selectAll(".legend-item").filter((function(t,e){return e!==i})).classed("inactive",!0),r.tooltipShow(e,a[i]),r.hovered.emit({event:t,data:e})},this.barMouseOut=function(){r.chart.selectAll(".bar").classed("inactive",!1).style("fill",null),r.chart.selectAll(".legend-item").classed("inactive",!1),r.tooltipHide()},this.barMouseClick=function(t,e,i,a){r.clicked.emit({event:t,data:e})},this.tooltipShow=function(t,e){var i=e.getBoundingClientRect(),a=r._scroll.getScrollPosition(),n=t.value/d.sum(r.data,(function(t){return t.value})),s=t.compareValue/d.sum(r.data,(function(t){return t.compareValue})),o="",l="",c="",u="",p="",g="",m=""+r.nullValueText,f="";if(!r.isSingleData)switch(r.tooltip.classed("pbds-tooltip-compare",null),r.tooltipLabelFormatType){case"number":o=r.tooltipLabelFormat(t.label);break;case"time":var x=h.isoParse(t.label);o=r.tooltipLabelFormat(x);break;default:o=t.label}r.isCompare&&t.compareStartDate&&t.compareEndDate&&(r.tooltip.classed("pbds-tooltip-compare",r.isCompare),l="mt-2",c=r.tooltipDateFormat(h.isoParse(t.compareStartDate))+" - "+r.tooltipDateFormat(h.isoParse(t.compareEndDate))),r.percentage&&r.isCompare&&t.compareValue?u=null===r.tooltipValueFormat?r.tooltipPercentFormat(s)+" ("+t.comparveValue+r.tooltipValueSuffix+")":r.tooltipPercentFormat(s)+" ("+r.tooltipValueFormat(t.compareValue)+r.tooltipValueSuffix+")":r.isCompare&&null!==t.compareValue?u=null===r.tooltipValueFormat?""+t.compareValue+r.tooltipValueSuffix+" ("+r.tooltipPercentFormat(s)+")":""+r.tooltipValueFormat(t.compareValue)+r.tooltipValueSuffix+" ("+r.tooltipPercentFormat(s)+")":r.isCompare&&null===t.compareValue&&(u=""+r.nullValueText),t.startDate&&t.endDate&&(g=r.tooltipDateFormat(h.isoParse(t.startDate))+" - "+r.tooltipDateFormat(h.isoParse(t.endDate))),""!==o&&(p="mt-2"),r.isSingleData&&r.percentage&&t.value?m=null===r.tooltipValueFormat?""+t.value:""+r.tooltipValueFormat(t.value):r.isSingleData&&null!==t.value?m=null===r.tooltipValueFormat?""+t.value+r.tooltipValueSuffix:""+r.tooltipValueFormat(t.value)+r.tooltipValueSuffix:!r.isSingleData&&r.percentage&&null!==t.value?m=null===r.tooltipValueFormat?r.tooltipPercentFormat(n)+" ("+t.value+r.tooltipValueSuffix+")":r.tooltipPercentFormat(n)+" ("+r.tooltipValueFormat(t.value)+r.tooltipValueSuffix+")":r.isSingleData||null===t.value||(m=null===r.tooltipValueFormat?""+t.value+r.tooltipValueSuffix+" ("+r.tooltipPercentFormat(n)+")":""+r.tooltipValueFormat(t.value)+r.tooltipValueSuffix+" ("+r.tooltipPercentFormat(n)+")"),!r.isSingleData&&r.isCompare&&null!==t.value&&null!==t.compareValue&&(f='<div class="metric-block-indicator '+t.compareChangeDirection+" "+(t.compareChangeInverse?"inverse":"")+' ml-2"><span>'+r.tooltipCompareChangeFormat(t.compareChangeValue)+"</span></div>"),r.tooltip.html((function(){return'\n        <div class="tooltip-label font-weight-bold">'+o+'</div>\n        <div class="'+l+'">'+c+'</div>\n        <div class="tooltip-value font-weight-bold">'+u+'</div>\n        <div class="'+p+'">'+g+'</div>\n        <div class="tooltip-value"><span class="font-weight-bold">'+m+"</span> <span>"+f+"</span></div>\n      "}));var y=+r.tooltip.node().offsetWidth/2,v=+r.tooltip.node().offsetHeight;r.tooltip.style("top",+a[1]+ +i.top-v-8+"px"),r.data.length>1?r.tooltip.style("left",+a[0]+ +i.left-y+ +i.width/2+"px"):r.tooltip.style("left",+a[0]-y+ +i.right+"px"),r.tooltip.style("opacity",1)},this.tooltipHide=function(){r.tooltip.style("opacity",0)},this.legendMouseOver=function(t,e,i,a){if(!r.hideLegendTooltip){var n=r.svg.selectAll(".bar").filter((function(t,e){return e===i})).node();r.tooltipShow(e,n)}r.chart.selectAll(".legend-item").filter((function(t,e){return e!==i})).classed("inactive",!0),r.chart.selectAll(".bar").filter((function(t,e){return e!==i})).classed("inactive",!0),r.chart.selectAll(".bar").filter((function(t,e){return e===i})).classed("inactive",null),r.hovered.emit({event:t,data:e})},this.legendMouseOut=function(){r.chart.selectAll(".legend-item").classed("inactive",!1),r.chart.selectAll(".bar").classed("inactive",!1).style("fill",null),r.tooltipHide()},this.legendMouseClick=function(t,e,i,a){r.clicked.emit({event:t,data:e})},this.xAxisFormatter=function(t){switch(r.xAxisFormatType){case"number":return""+r.xAxisFormat(t)+r.xAxisTickLabelSuffix;default:return""+t+r.xAxisTickLabelSuffix}}}return t.prototype.ngOnInit=function(){var t,e=this;this.height=+this.height+this.barPadding,this.margin={top:+this.marginTop,right:+this.marginRight,bottom:+this.marginBottom,left:+this.marginLeft},this.isSingleData=1===this.data.length,this.isCompare=Object.keys(this.data[0]).includes("compareValue"),this.xAxisFormat=this._dataviz.d3Format(this.xAxisFormatType,this.xAxisFormatString),this.legendLabelFormat=this._dataviz.d3Format(this.legendLabelFormatType,this.legendLabelFormatString),this.tooltipValueFormat=this._dataviz.d3Format(this.tooltipValueFormatType,this.tooltipValueFormatString),this.tooltipDateFormat=h.timeFormat(this.tooltipDateFormatString),this.tooltipPercentFormat=l.format(this.tooltipPercentFormatString),this.tooltipCompareChangeFormat=l.format(this.compareChangeFormatString),this.hideXAxisZero=!1,this.hideXAxisDomain=!0,this.hideXAxisTicks=!0,this.xAxisTickSize=8,this.xAxisTickSizeOuter=0,this.xAxisTitleMargin=this.xAxisTitle?20:0,this.hideLegend||"right"!==this.legendPosition||(this.width=+this.width-+this.legendWidth),this.chart=n.select(this._element.nativeElement).attr("aria-hidden","true"),this.svg=this.chart.append("svg").attr("width",(function(){return+e.width+e.margin.left+e.margin.right})).attr("height",+this.height+this.margin.top+this.margin.bottom+this.xAxisTitleMargin).attr("class","img-fluid").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox",(function(){return"-"+e.margin.left+" -"+e.margin.top+" "+(+e.width+e.margin.left+e.margin.right)+" "+(+e.height+e.margin.top+e.margin.bottom+e.xAxisTitleMargin)})),this.hideTooltip||(this.tooltip=n.select("body").append("div").attr("class","pbds-tooltip south").classed("pbds-tooltip-compare",this.isCompare).style("opacity",0).attr("aria-hidden","true")),!this.hideLegend&&this.data.length>1&&(this.chart.classed("pbds-chart-legend-bottom","bottom"===this.legendPosition),this.chart.append("ul").attr("class","legend legend-"+this.legendPosition)),this.xAxisScale=s.scaleLinear().domain([0,Math.ceil(d.sum(this.data,(function(t){return t.value})))]).range([0,+this.width]),this.xAxisCall=u.axisBottom(this.xAxisScale).ticks(this.xAxisTicks).tickSize(this.xAxisTickSize).tickSizeOuter(this.xAxisTickSizeOuter).tickFormat(this.xAxisFormatter),this.xAxis=this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+this.height+")").classed("axis-hidden",this.hideXAxis).classed("axis-zero-hidden",this.hideXAxisZero).classed("axis-domain-hidden",this.hideXAxisDomain).classed("axis-ticks-hidden",this.hideXAxisTicks),this.hideXGrid||(this.xGridCall=u.axisBottom(this.xAxisScale).tickSize(-this.height),this.xGrid=this.svg.append("g").attr("class","grid grid-x").classed("grid-zero-hidden",this.hideXAxisZero).attr("transform","translate(0, "+this.height+")").call(this.xGridCall)),this.xAxisTitle&&this.svg.append("text").attr("class","axis-title").attr("text-anchor","center").attr("x",this.width/2-this.margin.left).attr("y",this.height+this.margin.top+(this.hideXAxis?0:40)).text(this.xAxisTitle),t=this.isSingleData?this._dataviz.createGradientDefs(this.svg,this.monochrome,this.theme,!1):this.monochrome?this._dataviz.getColors(this.monochrome,this.theme).reverse():this._dataviz.getColors(this.monochrome,this.theme),this.colorRange=s.scaleOrdinal().range(t),this.updateChart()},t.prototype.ngOnChanges=function(t){t.data&&!t.data.firstChange&&this.updateChart()},t.prototype.ngOnDestroy=function(){this.tooltip&&this.tooltip.remove()},t.prototype.updateChart=function(){var t=this;this.isSingleData=1===this.data.length,this.isCompare=Object.keys(this.data[0]).includes("compareValue");var e=d.sum(this.data,(function(t){return t.value})),i=0===this.data[this.data.length-1].value||null===this.data[this.data.length-1].value,a=0,s=O(this.data),r=!1;s.reverse().forEach((function(t,e,i){0!==t.value&&null!==t.value||r?r=!0:a++})),this.percentage&&!this.isSingleData?(this.xAxisScale.domain([0,e]).range([0,+this.width]),this.xAxisCall.tickValues([0,.25*e,.5*e,.75*e,e]),this.xAxis.call(this.xAxisCall),this.xGridCall.tickValues([0,.25*e,.5*e,.75*e,e]),this.xGrid.call(this.xGridCall),this.svg.select(".axis-x").selectAll("text").html((function(t,e){return l.format(".0%")(.25*e)}))):this.percentage&&this.isSingleData?(this.xAxisScale.domain([0,1]).range([0,+this.width]),this.xAxisCall.tickValues([0,.25,.5,.75,1]),this.xAxis.call(this.xAxisCall),this.xGridCall.tickValues([0,.25,.5,.75,1]),this.xGrid.call(this.xGridCall),this.svg.select(".axis-x").selectAll("text").html((function(t,e){return l.format(".0%")(.25*e)}))):(this.xAxisScale.domain([0,Math.ceil(e)]).range([0,+this.width]),this.xGridCall.tickValues(this.xAxisScale.ticks().filter((function(t){return Number.isInteger(t)}))),this.xAxis.transition().duration(1e3).call(this.xAxisCall),this.hideXGrid||this.xGrid.transition().duration(1e3).call(this.xGridCall)),this.svg.selectAll(".bar").data(this.data).join((function(e){return e.append("rect").attr("class","bar").attr("width",0).attr("height",(function(){return t.height-t.barPadding})).attr("fill",(function(e){return t.isSingleData?"url("+t._location.path()+"#gradient-horizontal-"+t.colorRange(e.label).substr(1)+")":t.colorRange(e.label)})).attr("y",(function(){return t.barPadding/2})).attr("x",(function(e,i){return t.data.slice(0,i).reduce((function(e,i){return+e+ +t.xAxisScale(i.value)}),1)})).attr("pointer-events","none").call((function(e){return e.transition().delay((function(t,e){return 250*e})).ease(p.easeLinear).attr("width",(function(e,n){if(n===t.data.length-a-1&&i)return t.xAxisScale(e.value);if(n!==t.data.length-1){var s=t.xAxisScale(e.value)-+t.barMargin;return s=-1===Math.sign(s)?0:s}return t.xAxisScale(e.value)})).transition().attr("pointer-events","auto")}))}),(function(e){return e.attr("pointer-events","none").transition().duration(1e3).attr("width",(function(e,i){return null===e.value||0===e.value?t.xAxisScale(0):i===t.data.length-1?t.xAxisScale(e.value):t.xAxisScale(e.value)-t.barMargin})).attr("x",(function(e,i){return t.data.slice(0,i).reduce((function(e,i){return e+ +t.xAxisScale(i.value)}),0)})).transition().attr("pointer-events","auto")}),(function(t){return t.transition().attr("pointer-events","none").remove()})).on("mouseover",(function(e,i,a){return t.barMouseOver(n.event,e,i,a)})).on("mouseout",(function(e,i,a){return t.barMouseOut()})).on("click",(function(e,i,a){return t.barMouseClick(n.event,e,i,a)})),this.hideLegend||this.chart.select(".legend").selectAll(".legend-item").data(this.data).join((function(e){var i=e.append("li").attr("class","legend-item").classed("align-items-start",t.isCompare);return i.insert("span").attr("class","legend-key").style("background-color",(function(e){return t.colorRange(e.label)})).classed("mt-1",t.isCompare),i.insert("span").attr("class","legend-description").classed("d-flex",t.isCompare).classed("flex-column",t.isCompare),i.select(".legend-description").insert("span").attr("class","legend-label").html((function(e){switch(t.legendLabelFormatType){case"number":return t.legendLabelFormat(e.label);case"time":var i=h.isoParse(e.label);return t.legendLabelFormat(i);default:return e.label}})),i.select(".legend-description").insert("div").attr("class","legend-change").classed("d-none",!t.isCompare),i.select(".legend-change").html((function(e){return'<div class="metric-block-indicator '+e.compareChangeDirection+" "+(e.compareChangeInverse?"inverse":"")+' mt-1"><span>'+t.tooltipCompareChangeFormat(e.compareChangeValue)+"</span></div>"})),i}),(function(e){return e.classed("align-items-start",t.isCompare),e.select(".legend-key").classed("mt-1",t.isCompare),e.select(".legend-change").classed("d-none",!t.isCompare),t.isCompare&&e.select(".legend-change").html((function(e){return'<div class="metric-block-indicator '+e.compareChangeDirection+" "+(e.compareChangeInverse?"inverse":"")+' mt-1"><span>'+t.tooltipCompareChangeFormat(e.compareChangeValue)+"</span></div>"})),e.select(".legend-label").html((function(e){switch(t.legendLabelFormatType){case"number":return t.legendLabelFormat(e.label);case"time":var i=h.isoParse(e.label);return t.legendLabelFormat(i);default:return e.label}})),e}),(function(t){return t.remove()})).on("mouseover",(function(e,i,a){return t.legendMouseOver(n.event,e,i,a)})).on("mouseout",(function(){return t.legendMouseOut()})).on("click",(function(e,i,a){return t.legendMouseClick(n.event,e,i,a)}))},t}();P.decorators=[{type:e.Component,args:[{selector:"pbds-dataviz-bar-single-horizontal",template:"",changeDetection:e.ChangeDetectionStrategy.OnPush}]}],P.ctorParameters=function(){return[{type:v},{type:e.ElementRef},{type:i.ViewportScroller},{type:i.Location}]},P.propDecorators={chartClass:[{type:e.HostBinding,args:["class.pbds-chart"]}],singleStackedBarClass:[{type:e.HostBinding,args:["class.pbds-chart-bar-single-horizontal"]}],data:[{type:e.Input}],width:[{type:e.Input}],height:[{type:e.Input}],nullValueText:[{type:e.Input}],percentage:[{type:e.Input}],marginTop:[{type:e.Input}],marginRight:[{type:e.Input}],marginBottom:[{type:e.Input}],marginLeft:[{type:e.Input}],barMargin:[{type:e.Input}],hideXAxis:[{type:e.Input}],xAxisTicks:[{type:e.Input}],xAxisTitle:[{type:e.Input}],xAxisFormatType:[{type:e.Input}],xAxisFormatString:[{type:e.Input}],xAxisTickLabelSuffix:[{type:e.Input}],hideXGrid:[{type:e.Input}],hideLegend:[{type:e.Input}],hideLegendTooltip:[{type:e.Input}],legendWidth:[{type:e.Input}],legendPosition:[{type:e.Input}],legendLabelFormatType:[{type:e.Input}],legendLabelFormatString:[{type:e.Input}],hideTooltip:[{type:e.Input}],tooltipLabelFormatType:[{type:e.Input}],tooltipLabelFormatString:[{type:e.Input}],tooltipDateFormatString:[{type:e.Input}],tooltipValueFormatType:[{type:e.Input}],tooltipValueFormatString:[{type:e.Input}],tooltipValueSuffix:[{type:e.Input}],tooltipPercentFormatString:[{type:e.Input}],compareChangeFormatString:[{type:e.Input}],monochrome:[{type:e.Input}],theme:[{type:e.Input}],hovered:[{type:e.Output}],clicked:[{type:e.Output}]};var V=function(){};V.decorators=[{type:e.NgModule,args:[{declarations:[b,A,F,k,w,T,I,L,C,B,z,R,P],imports:[i.CommonModule,a.NgbTooltipModule],exports:[b,A,F,k,w,T,I,L,C,B,z,R,P]}]}];var j=function(){function t(t){this._scroll=t}return t.prototype.onWindowScroll=function(){var t=this._scroll.getScrollPosition();this.shadow=t[1]>20},t}();j.decorators=[{type:e.Directive,args:[{selector:"header.bg-brand-header"}]}],j.ctorParameters=function(){return[{type:i.ViewportScroller}]},j.propDecorators={shadow:[{type:e.HostBinding,args:["class.pbds-header-shadow"]}],onWindowScroll:[{type:e.HostListener,args:["window:scroll",[]]}]};var _=function(){};_.decorators=[{type:e.NgModule,args:[{declarations:[j],imports:[i.CommonModule],exports:[j]}]}];var G=function(){function t(t){this.localeId=t,this.locale=this.localeId.toLowerCase()}return t.prototype.setLocale=function(t){this.locale=(t.language+"-"+t.country).toLowerCase(),i.registerLocaleData(t.locale,this.locale)},t.prototype.getCurrentLocale=function(){return this.locale},t}();G.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new G(e.ɵɵinject(e.LOCALE_ID))},token:G,providedIn:"root"}),G.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],G.ctorParameters=function(){return[{type:String,decorators:[{type:e.Inject,args:[e.LOCALE_ID]}]}]};var X=function(t){function e(e){var i=t.call(this)||this;return i.daterangeService=e,i}return function(t,e){function i(){this.constructor=t}D(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}(e,t),e.prototype.getWeekdayShortName=function(t){return t=7===t?0:t,i.getLocaleDayNames(this.daterangeService.getCurrentLocale(),i.FormStyle.Standalone,i.TranslationWidth.Abbreviated)[t]},e.prototype.getMonthShortName=function(t){return i.getLocaleMonthNames(this.daterangeService.getCurrentLocale(),i.FormStyle.Standalone,i.TranslationWidth.Wide)[t-1]},e.prototype.getMonthFullName=function(t){return i.getLocaleMonthNames(this.daterangeService.getCurrentLocale(),i.FormStyle.Standalone,i.TranslationWidth.Wide)[t-1]},e.prototype.getDayAriaLabel=function(t){return t.day+"-"+t.month+"-"+t.year},e}(a.NgbDatepickerI18n);X.decorators=[{type:e.Injectable}],X.ctorParameters=function(){return[{type:G}]};var E=function(){function t(t,a){var n=this;this.calendar=t,this.daterangeService=a,this.presets=[{label:"All Dates",value:null},{label:"Last 7 Days",value:7},{label:"Last 30 Days",value:30},{label:"Year to Date",value:365}],this.presetSelected=null,this.filterSelected=0,this.showCustomPreset=!0,this.applyText="Apply",this.cancelText="Cancel",this.customRangeText="Custom Range",this.minDate=this.calendar.getPrev(this.calendar.getToday(),"y"),this.maxDate=this.calendar.getToday(),this.fromDate=null,this.toDate=null,this.inputFormat="{fromDate} to {toDate}",this.change=new e.EventEmitter,this.firstDayOfWeek=i.getLocaleFirstDayOfWeek(this.daterangeService.getCurrentLocale()),this.dateRange="",this.isDatepickerVisible=!1,this.presetSelect=function(t){if("custom"===t.value)return n.presetSelected="custom",!1;t.value?(n.toDate=n.calendar.getToday(),n.fromDate=n.calendar.getPrev(n.toDate,"d",t.value),n.presetSelected=t.value):(n.fromDate=null,n.toDate=null,n.presetSelected=null),n.isDatepickerVisible=!1},this.isHovered=function(t){return n.fromDate&&!n.toDate&&n.hoveredDate&&t.after(n.fromDate)&&t.before(n.hoveredDate)},this.isInside=function(t){return t.after(n.fromDate)&&t.before(n.toDate)},this.isRange=function(t){return t.equals(n.fromDate)||t.equals(n.toDate)||n.isInside(t)||n.isHovered(t)}}return t.prototype.ngOnInit=function(){this.firstDayOfWeek="zh-cn"===this.daterangeService.getCurrentLocale()?this.firstDayOfWeek+1:this.firstDayOfWeek,"custom"===this.presetSelected&&this.showDatepicker()},t.prototype.ngOnChanges=function(t){var e=this;t.filters&&this.filters&&(this.selectedFilter=this.filters[this.filterSelected]),t.presets&&(!this.filters&&this.presetSelected?this.presetClick(this.presets.find((function(t){return t.value===e.presetSelected}))):this.presetSelected&&(this.presetSelect({value:this.presetSelected}),this.apply())),this.setInputLabel()},t.prototype.apply=function(){this.setInputLabel(),this.change.emit({fromDate:this.fromDate,toDate:this.toDate,formattedDate:this.isDatepickerVisible?this.dateFormat():this.dateRange,filter:this.filters?this.selectedFilter.field:null,value:this.presetSelected}),this.datepickerPopup.close()},t.prototype.cancel=function(){this.datepickerPopup.close()},t.prototype.onDateSelection=function(t){this.fromDate||this.toDate?this.fromDate&&!this.toDate&&t.after(this.fromDate)?this.toDate=t:(this.toDate=null,this.fromDate=t):this.fromDate=t},t.prototype.presetClick=function(t){if(t){if("custom"===t.value)return!1;t.value?(this.toDate=this.calendar.getToday(),this.fromDate=this.calendar.getPrev(this.toDate,"d",t.value),this.presetSelected=t.value):(this.fromDate=null,this.toDate=null,this.presetSelected=null),this.isDatepickerVisible=!1,this.apply()}},t.prototype.getFormattedDate=function(t){if(t){var e=this.daterangeService.getCurrentLocale(),a=i.getLocaleDateFormat(e,i.FormatWidth.Short);return i.formatDate(t.month+"/"+t.day+"/"+t.year,a,e)}},t.prototype.showDatepicker=function(){this.isDatepickerVisible=!0,this.presetSelect({value:"custom"})},t.prototype.onFilterChange=function(t,e){this.selectedFilter=this.filters[e]},t.prototype.setPreset=function(t){this.presetSelected=t,this.presetSelect({value:this.presetSelected}),this.apply()},t.prototype.setFilter=function(t){void 0!==this.filters&&(this.selectedFilter=this.filters[t])},t.prototype.setDateRange=function(t){this.fromDate=new a.NgbDate(t.fromDate.year,t.fromDate.month,t.fromDate.day),this.toDate=new a.NgbDate(t.toDate.year,t.toDate.month,t.toDate.day),this.isDatepickerVisible="custom"===t.value,this.presetSelected=t.value,this.filters&&(this.filterSelected=this.filters.findIndex((function(e){return e.field===t.filter})),this.selectedFilter=this.filters[this.filterSelected]),this.apply()},t.prototype.setInputLabel=function(){var t=this;if(this.presets){var e=this.presets.find((function(e){return e.value===t.presetSelected}));e?null===this.fromDate||null===this.toDate||null===this.presetSelected||null!==this.presetSelected&&"custom"!==this.presetSelected?this.dateRange=e.label:this.dateRange=this.dateFormat():"custom"===this.presetSelected&&this.fromDate&&this.toDate&&(this.dateRange=this.dateFormat())}},t.prototype.dateFormat=function(){return this.inputFormat.replace("{fromDate}",this.getFormattedDate(this.fromDate)).replace("{toDate}",this.getFormattedDate(this.toDate))},t}();E.decorators=[{type:e.Component,args:[{selector:"pbds-daterange-popover",template:'<div class="input-group pbds-daterange-popover">\n  <input\n    type="text"\n    class="form-control"\n    aria-describedby="daterange-button"\n    [value]="dateRange"\n    readonly="readonly"\n    tabindex="-1"\n  />\n\n  <div class="input-group-append">\n    <button\n      class="btn btn-secondary"\n      type="button"\n      id="daterange-button"\n      #datepickerPopup="ngbPopover"\n      [ngbPopover]="daterangeContent"\n      popoverClass="daterange-popover"\n      autoClose="outside"\n      container="body"\n      placement="bottom-right auto"\n      aria-label="Open Daterange Picker"\n    >\n      <i class="pbi-icon-mini pbi-calendar" aria-hidden="true"></i>\n    </button>\n  </div>\n\n  <ng-template #daterangeContent>\n    <div>\n      <div class="d-block d-md-flex">\n        <div *ngIf="isDatepickerVisible">\n          <ngb-datepicker\n            #datepicker\n            [displayMonths]="\'2\'"\n            [minDate]="minDate"\n            [maxDate]="maxDate"\n            navigation="select"\n            outsideDays="hidden"\n            [firstDayOfWeek]="firstDayOfWeek"\n            [showWeekdays]="true"\n            [dayTemplate]="t"\n            (select)="onDateSelection($event)"\n          >\n          </ngb-datepicker>\n          \x3c!--  --\x3e\n\n          <ng-template #t let-date let-focused="focused">\n            <span\n              class="custom-day"\n              [class.focused]="focused"\n              [class.range]="isRange(date)"\n              [class.faded]="isHovered(date) || isInside(date)"\n              (mouseenter)="hoveredDate = date"\n              (mouseleave)="hoveredDate = null"\n            >\n              {{ date.day }}\n            </span>\n          </ng-template>\n        </div>\n\n        <div\n          class="d-flex flex-column justify-content-lg-between mt-md-0"\n          [ngClass]="{ \'ml-md-4\': isDatepickerVisible }"\n        >\n          \x3c!-- filters --\x3e\n          <div *ngIf="filters" class="mb-3" ngbDropdown>\n            <button class="btn btn-sm btn-secondary btn-block" id="dateFilter" ngbDropdownToggle>\n              {{ selectedFilter.label }}\n            </button>\n            <div ngbDropdownMenu aria-labelledby="dateFilter">\n              <button\n                class="dropdown-item"\n                type="button"\n                *ngFor="let filter of filters; let index = index"\n                (click)="onFilterChange(filter, index)"\n              >\n                {{ filter.label }}\n              </button>\n            </div>\n          </div>\n\n          \x3c!-- presets radio buttons--\x3e\n          <div *ngIf="presets && filters" class="flex-grow-1">\n            <mat-radio-group\n              aria-label="Select an option"\n              class="stacked-radio-group"\n              name="presets"\n              [(ngModel)]="presetSelected"\n              (change)="presetSelect($event)"\n            >\n              <mat-radio-button *ngFor="let preset of presets" [value]="preset.value">{{\n                preset.label\n              }}</mat-radio-button>\n\n              <mat-radio-button *ngIf="showCustomPreset" [value]="\'custom\'" (change)="showDatepicker()">{{\n                customRangeText\n              }}</mat-radio-button>\n            </mat-radio-group>\n          </div>\n\n          \x3c!-- presets buttons--\x3e\n          <div *ngIf="presets && !filters" class="flex-grow-1">\n            <button\n              type="button"\n              class="btn btn-secondary btn-block btn-sm text-nowrap"\n              *ngFor="let preset of presets"\n              (click)="presetClick(preset)"\n            >\n              {{ preset.label }}\n            </button>\n\n            <button\n              type="button"\n              class="btn btn-secondary btn-block btn-sm text-nowrap"\n              *ngIf="showCustomPreset"\n              (click)="showDatepicker()"\n            >\n              {{ customRangeText }}\n            </button>\n          </div>\n\n          \x3c!-- buttons --\x3e\n          <div *ngIf="filters || isDatepickerVisible" class="d-flex justify-content-between mt-3">\n            <button class="btn btn-primary btn-sm mr-1" type="button" (click)="apply()">{{ applyText }}</button>\n            <button class="btn btn-secondary btn-sm ml-1" type="button" (click)="cancel()">\n              {{ cancelText }}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </ng-template>\n</div>\n',providers:[{provide:a.NgbDatepickerI18n,useClass:X}]}]}],E.ctorParameters=function(){return[{type:a.NgbCalendar},{type:G}]},E.propDecorators={datepickerPopup:[{type:e.ViewChild,args:["datepickerPopup",{static:!0}]}],presets:[{type:e.Input}],presetSelected:[{type:e.Input}],filters:[{type:e.Input}],filterSelected:[{type:e.Input}],showCustomPreset:[{type:e.Input}],applyText:[{type:e.Input}],cancelText:[{type:e.Input}],customRangeText:[{type:e.Input}],minDate:[{type:e.Input}],maxDate:[{type:e.Input}],fromDate:[{type:e.Input}],toDate:[{type:e.Input}],inputFormat:[{type:e.Input}],change:[{type:e.Output}]};var Y=function(){};Y.decorators=[{type:e.NgModule,args:[{declarations:[E],imports:[i.CommonModule,x.FormsModule,y.MatRadioModule,a.NgbDatepickerModule,a.NgbPopoverModule,a.NgbDropdownModule],exports:[E]}]}];var H=function(){this.layout="container"};H.decorators=[{type:e.Component,args:[{selector:"pbds-page-title",template:'<div class="page-header">\n  <div class="page-title" [ngClass]="layout">\n    <div class="row">\n      <div class="col">\n        <h1 [ngClass]="{ \'mb-0\': sub, \'has-sub\': sub }">{{ ttl }}</h1>\n        <h2>{{ sub }}</h2>\n      </div>\n    </div>\n  </div>\n</div>\n',styles:[".page-header h1.has-sub{margin-bottom:0;margin-top:85px}.page-title h1.mb-0+h2{font-size:16px;line-height:1.4;margin-bottom:25px}"]}]}],H.propDecorators={ttl:[{type:e.Input}],sub:[{type:e.Input}],layout:[{type:e.Input}]};var W=function(){};W.decorators=[{type:e.NgModule,args:[{declarations:[H],imports:[i.CommonModule],exports:[H]}]}];var N=function(){function t(){this.storagekey=!1,this.minimum=1,this.toggle=new e.EventEmitter}return t.prototype.ngOnInit=function(){var t=this;this.storagekey&&(this.columnStorage=localStorage.getItem(this.storagekey),this.columnStorage&&(this.columnStorage=JSON.parse(this.columnStorage),this.columns.map((function(e){var i=t.columnStorage.find((function(t){return t.field===e.field}));e.toggle.selected=!i||i.toggle.selected}))),this.setLocalStorage()),this.updateTotalSelected()},t.prototype.toggleColumn=function(t){this.totalSelected===this.minimum&&t.toggle.selected||(t.toggle.selected=!t.toggle.selected,this.storagekey&&this.setLocalStorage(),this.toggle.emit({showAll:!1,column:t,columns:this.columns}),this.updateTotalSelected())},t.prototype.showAllColumns=function(t){this.columns.map((function(t){t.toggle.visible&&(t.toggle.selected=!0)})),this.storagekey&&this.setLocalStorage(),this.toggle.emit({showAll:!0,column:null,columns:this.columns}),this.updateTotalSelected(),t.close()},t.prototype.showSelectedIcon=function(t){return t.toggle.selected?"":"invisible"},t.prototype.setLocalStorage=function(){this.storagekey&&localStorage.setItem(this.storagekey,JSON.stringify(this.columns))},t.prototype.updateTotalSelected=function(){this.totalSelected=this.columns.filter((function(t){return t.toggle.selected&&t.toggle.visible})).length},t}();N.decorators=[{type:e.Component,args:[{selector:"pbds-column-toggle",template:'<div ngbDropdown #columnToggleDropdown="ngbDropdown" [autoClose]="\'outside\'" class="d-inline-block">\n  <button class="btn btn-secondary" id="toggle-column" ngbDropdownToggle>\n    <i class="pbi-icon-mini pbi-column-toggle"></i>\n  </button>\n\n  <div ngbDropdownMenu aria-labelledby="toggle-column">\n    <ng-container *ngFor="let column of columns">\n      <button *ngIf="column.toggle.visible" class="dropdown-item" (click)="toggleColumn(column)">\n        <i class="pbi-icon-mini pbi-check small mr-1" [ngClass]="showSelectedIcon(column)"></i>\n        {{ column.header }}\n      </button>\n    </ng-container>\n\n    <div class="dropdown-divider"></div>\n\n    <button class="dropdown-item" (click)="showAllColumns(columnToggleDropdown)">Show All</button>\n  </div>\n</div>\n'}]}],N.propDecorators={columns:[{type:e.Input}],storagekey:[{type:e.Input}],minimum:[{type:e.Input}],toggle:[{type:e.Output}]};var Z=function(){};Z.decorators=[{type:e.NgModule,args:[{declarations:[N],imports:[i.CommonModule,a.NgbDropdownModule],exports:[N]}]}];var q=function(){};q.decorators=[{type:e.NgModule,args:[{declarations:[],imports:[V,_,Y,W,Z],exports:[V,_,Y,W,Z]}]}],t.PbdsComponentsModule=q,t.ɵa=V,t.ɵb=b,t.ɵc=v,t.ɵd=A,t.ɵe=F,t.ɵf=k,t.ɵg=w,t.ɵh=T,t.ɵi=I,t.ɵj=C,t.ɵk=L,t.ɵl=B,t.ɵm=z,t.ɵn=R,t.ɵo=P,t.ɵp=_,t.ɵq=j,t.ɵr=Y,t.ɵs=X,t.ɵt=E,t.ɵu=G,t.ɵv=W,t.ɵw=H,t.ɵx=Z,t.ɵy=N,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=pb-design-system.umd.min.js.map