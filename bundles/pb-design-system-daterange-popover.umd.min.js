!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("@angular/forms"),require("@ng-bootstrap/ng-bootstrap"),require("@angular/material/radio")):"function"==typeof define&&define.amd?define("pb-design-system/daterange-popover",["exports","@angular/core","@angular/common","@angular/forms","@ng-bootstrap/ng-bootstrap","@angular/material/radio"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self)["pb-design-system"]=e["pb-design-system"]||{},e["pb-design-system"]["daterange-popover"]={}),e.ng.core,e.ng.common,e.ng.forms,e["^7"][0][0],e.ng.material.radio)}(this,(function(e,t,n,a,r,o){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};Object.create;Object.create;var i=function(){function e(e){this.localeId=e,this.locale=this.localeId.toLowerCase()}return e.prototype.setLocale=function(e){this.locale=(e.language+"-"+e.country).toLowerCase(),n.registerLocaleData(e.locale,this.locale)},e.prototype.getCurrentLocale=function(){return this.locale},e}();i.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new i(t.ɵɵinject(t.LOCALE_ID))},token:i,providedIn:"root"}),i.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],i.ctorParameters=function(){return[{type:String,decorators:[{type:t.Inject,args:[t.LOCALE_ID]}]}]};var l=function(e){function t(t){var n=e.call(this)||this;return n.daterangeService=t,n}return function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.getWeekdayShortName=function(e){return e=7===e?0:e,n.getLocaleDayNames(this.daterangeService.getCurrentLocale(),n.FormStyle.Standalone,n.TranslationWidth.Abbreviated)[e]},t.prototype.getMonthShortName=function(e){return n.getLocaleMonthNames(this.daterangeService.getCurrentLocale(),n.FormStyle.Standalone,n.TranslationWidth.Wide)[e-1]},t.prototype.getMonthFullName=function(e){return n.getLocaleMonthNames(this.daterangeService.getCurrentLocale(),n.FormStyle.Standalone,n.TranslationWidth.Wide)[e-1]},t.prototype.getDayAriaLabel=function(e){return e.day+"-"+e.month+"-"+e.year},t}(r.NgbDatepickerI18n);l.decorators=[{type:t.Injectable}],l.ctorParameters=function(){return[{type:i}]};var c=function(){function e(e,a){var r=this;this.calendar=e,this.daterangeService=a,this.presets=[{label:"All Dates",value:null},{label:"Last 7 Days",value:7},{label:"Last 30 Days",value:30},{label:"Year to Date",value:365}],this.presetSelected=null,this.filterSelected=0,this.showCustomPreset=!0,this.applyText="Apply",this.cancelText="Cancel",this.customRangeText="Custom Range",this.minDate=this.calendar.getPrev(this.calendar.getToday(),"y"),this.maxDate=this.calendar.getToday(),this.fromDate=null,this.toDate=null,this.inputFormat="{fromDate} to {toDate}",this.change=new t.EventEmitter,this.firstDayOfWeek=n.getLocaleFirstDayOfWeek(this.daterangeService.getCurrentLocale()),this.dateRange="",this.isDatepickerVisible=!1,this.presetSelect=function(e){if("custom"===e.value)return r.presetSelected="custom",!1;e.value?(r.toDate=r.calendar.getToday(),r.fromDate=r.calendar.getPrev(r.toDate,"d",e.value),r.presetSelected=e.value):(r.fromDate=null,r.toDate=null,r.presetSelected=null),r.isDatepickerVisible=!1},this.isHovered=function(e){return r.fromDate&&!r.toDate&&r.hoveredDate&&e.after(r.fromDate)&&e.before(r.hoveredDate)},this.isInside=function(e){return e.after(r.fromDate)&&e.before(r.toDate)},this.isRange=function(e){return e.equals(r.fromDate)||e.equals(r.toDate)||r.isInside(e)||r.isHovered(e)}}return e.prototype.ngOnInit=function(){this.firstDayOfWeek="zh-cn"===this.daterangeService.getCurrentLocale()?this.firstDayOfWeek+1:this.firstDayOfWeek,"custom"===this.presetSelected&&this.showDatepicker()},e.prototype.ngOnChanges=function(e){var t=this;e.filters&&this.filters&&(this.selectedFilter=this.filters[this.filterSelected]),e.presets&&(!this.filters&&this.presetSelected?this.presetClick(this.presets.find((function(e){return e.value===t.presetSelected}))):this.presetSelected&&(this.presetSelect({value:this.presetSelected}),this.apply())),this.setInputLabel()},e.prototype.apply=function(){this.setInputLabel(),this.change.emit({fromDate:this.fromDate,toDate:this.toDate,formattedDate:this.isDatepickerVisible?this.dateFormat():this.dateRange,filter:this.filters?this.selectedFilter.field:null,value:this.presetSelected}),this.datepickerPopup.close()},e.prototype.cancel=function(){this.datepickerPopup.close()},e.prototype.onDateSelection=function(e){this.fromDate||this.toDate?this.fromDate&&!this.toDate&&e.after(this.fromDate)?this.toDate=e:(this.toDate=null,this.fromDate=e):this.fromDate=e},e.prototype.presetClick=function(e){if(e){if("custom"===e.value)return!1;e.value?(this.toDate=this.calendar.getToday(),this.fromDate=this.calendar.getPrev(this.toDate,"d",e.value),this.presetSelected=e.value):(this.fromDate=null,this.toDate=null,this.presetSelected=null),this.isDatepickerVisible=!1,this.apply()}},e.prototype.getFormattedDate=function(e){if(e){var t=this.daterangeService.getCurrentLocale(),a=n.getLocaleDateFormat(t,n.FormatWidth.Short);return n.formatDate(e.month+"/"+e.day+"/"+e.year,a,t)}},e.prototype.showDatepicker=function(){this.isDatepickerVisible=!0,this.presetSelect({value:"custom"})},e.prototype.onFilterChange=function(e,t){this.selectedFilter=this.filters[t]},e.prototype.setPreset=function(e){this.presetSelected=e,this.presetSelect({value:this.presetSelected}),this.apply()},e.prototype.setFilter=function(e){void 0!==this.filters&&(this.selectedFilter=this.filters[e])},e.prototype.setDateRange=function(e){this.fromDate=new r.NgbDate(e.fromDate.year,e.fromDate.month,e.fromDate.day),this.toDate=new r.NgbDate(e.toDate.year,e.toDate.month,e.toDate.day),this.isDatepickerVisible="custom"===e.value,this.presetSelected=e.value,this.filters&&(this.filterSelected=this.filters.findIndex((function(t){return t.field===e.filter})),this.selectedFilter=this.filters[this.filterSelected]),this.apply()},e.prototype.setInputLabel=function(){var e=this;if(this.presets){var t=this.presets.find((function(t){return t.value===e.presetSelected}));t?null===this.fromDate||null===this.toDate||null===this.presetSelected||null!==this.presetSelected&&"custom"!==this.presetSelected?this.dateRange=t.label:this.dateRange=this.dateFormat():"custom"===this.presetSelected&&this.fromDate&&this.toDate&&(this.dateRange=this.dateFormat())}},e.prototype.dateFormat=function(){return this.inputFormat.replace("{fromDate}",this.getFormattedDate(this.fromDate)).replace("{toDate}",this.getFormattedDate(this.toDate))},e}();c.decorators=[{type:t.Component,args:[{selector:"pbds-daterange-popover",template:'<div class="input-group pbds-daterange-popover">\n  <input\n    type="text"\n    class="form-control"\n    aria-describedby="daterange-button"\n    [value]="dateRange"\n    readonly="readonly"\n    tabindex="-1"\n  />\n\n  <div class="input-group-append">\n    <button\n      class="btn btn-secondary"\n      type="button"\n      id="daterange-button"\n      #datepickerPopup="ngbPopover"\n      [ngbPopover]="daterangeContent"\n      popoverClass="daterange-popover"\n      autoClose="outside"\n      container="body"\n      placement="bottom-right auto"\n      aria-label="Open Daterange Picker"\n    >\n      <i class="pbi-icon-mini pbi-calendar" aria-hidden="true"></i>\n    </button>\n  </div>\n\n  <ng-template #daterangeContent>\n    <div>\n      <div class="d-block d-md-flex">\n        <div *ngIf="isDatepickerVisible">\n          <ngb-datepicker\n            #datepicker\n            [displayMonths]="\'2\'"\n            [minDate]="minDate"\n            [maxDate]="maxDate"\n            navigation="select"\n            outsideDays="hidden"\n            [firstDayOfWeek]="firstDayOfWeek"\n            [showWeekdays]="true"\n            [dayTemplate]="t"\n            (select)="onDateSelection($event)"\n          >\n          </ngb-datepicker>\n          \x3c!--  --\x3e\n\n          <ng-template #t let-date let-focused="focused">\n            <span\n              class="custom-day"\n              [class.focused]="focused"\n              [class.range]="isRange(date)"\n              [class.faded]="isHovered(date) || isInside(date)"\n              (mouseenter)="hoveredDate = date"\n              (mouseleave)="hoveredDate = null"\n            >\n              {{ date.day }}\n            </span>\n          </ng-template>\n        </div>\n\n        <div\n          class="d-flex flex-column justify-content-lg-between mt-md-0"\n          [ngClass]="{ \'ml-md-4\': isDatepickerVisible }"\n        >\n          \x3c!-- filters --\x3e\n          <div *ngIf="filters" class="mb-3" ngbDropdown>\n            <button class="btn btn-sm btn-secondary btn-block" id="dateFilter" ngbDropdownToggle>\n              {{ selectedFilter.label }}\n            </button>\n            <div ngbDropdownMenu aria-labelledby="dateFilter">\n              <button\n                class="dropdown-item"\n                type="button"\n                *ngFor="let filter of filters; let index = index"\n                (click)="onFilterChange(filter, index)"\n              >\n                {{ filter.label }}\n              </button>\n            </div>\n          </div>\n\n          \x3c!-- presets radio buttons--\x3e\n          <div *ngIf="presets && filters" class="flex-grow-1">\n            <mat-radio-group\n              aria-label="Select an option"\n              class="stacked-radio-group"\n              name="presets"\n              [(ngModel)]="presetSelected"\n              (change)="presetSelect($event)"\n            >\n              <mat-radio-button *ngFor="let preset of presets" [value]="preset.value">{{\n                preset.label\n              }}</mat-radio-button>\n\n              <mat-radio-button *ngIf="showCustomPreset" [value]="\'custom\'" (change)="showDatepicker()">{{\n                customRangeText\n              }}</mat-radio-button>\n            </mat-radio-group>\n          </div>\n\n          \x3c!-- presets buttons--\x3e\n          <div *ngIf="presets && !filters" class="flex-grow-1">\n            <button\n              type="button"\n              class="btn btn-secondary btn-block btn-sm text-nowrap"\n              *ngFor="let preset of presets"\n              (click)="presetClick(preset)"\n            >\n              {{ preset.label }}\n            </button>\n\n            <button\n              type="button"\n              class="btn btn-secondary btn-block btn-sm text-nowrap"\n              *ngIf="showCustomPreset"\n              (click)="showDatepicker()"\n            >\n              {{ customRangeText }}\n            </button>\n          </div>\n\n          \x3c!-- buttons --\x3e\n          <div *ngIf="filters || isDatepickerVisible" class="d-flex justify-content-between mt-3">\n            <button class="btn btn-primary btn-sm mr-1" type="button" (click)="apply()">{{ applyText }}</button>\n            <button class="btn btn-secondary btn-sm ml-1" type="button" (click)="cancel()">\n              {{ cancelText }}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </ng-template>\n</div>\n',providers:[{provide:r.NgbDatepickerI18n,useClass:l}]}]}],c.ctorParameters=function(){return[{type:r.NgbCalendar},{type:i}]},c.propDecorators={datepickerPopup:[{type:t.ViewChild,args:["datepickerPopup",{static:!0}]}],presets:[{type:t.Input}],presetSelected:[{type:t.Input}],filters:[{type:t.Input}],filterSelected:[{type:t.Input}],showCustomPreset:[{type:t.Input}],applyText:[{type:t.Input}],cancelText:[{type:t.Input}],customRangeText:[{type:t.Input}],minDate:[{type:t.Input}],maxDate:[{type:t.Input}],fromDate:[{type:t.Input}],toDate:[{type:t.Input}],inputFormat:[{type:t.Input}],change:[{type:t.Output}]};var p=function(){};p.decorators=[{type:t.NgModule,args:[{declarations:[c],imports:[n.CommonModule,a.FormsModule,o.MatRadioModule,r.NgbDatepickerModule,r.NgbPopoverModule,r.NgbDropdownModule],exports:[c]}]}],e.CustomDatepickerI18n=l,e.PbdsDaterangePopoverComponent=c,e.PbdsDaterangePopoverModule=p,e.PbdsDaterangeService=i,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=pb-design-system-daterange-popover.umd.min.js.map