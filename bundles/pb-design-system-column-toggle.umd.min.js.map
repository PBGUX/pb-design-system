{"version":3,"sources":["../../../projects/pb-design-system/column-toggle/column-toggle.component.ts","../../../projects/pb-design-system/column-toggle/column-toggle.module.ts"],"names":["PbdsColumnToggleComponent","this","storagekey","minimum","toggle","EventEmitter","prototype","ngOnInit","_this","columnStorage","localStorage","getItem","JSON","parse","columns","map","column","savedColumn","find","obj","field","selected","setLocalStorage","updateTotalSelected","toggleColumn","totalSelected","emit","showAll","showAllColumns","columnToggleDropdown","visible","close","showSelectedIcon","setItem","stringify","filter","value","length","Component","args","selector","template","Input","Output","NgModule","declarations","imports","CommonModule","NgbDropdownModule","exports"],"mappings":"mjBAIA,SAAAA,IAUSC,KAAAC,YAA6B,EAG7BD,KAAAE,QAAkB,EAGlBF,KAAAG,OAAyC,IAAIC,EAAAA,oBAK7CL,EAAAM,UAAAC,SAAA,WAAA,IAAAC,EAAAP,KACDA,KAAKC,aACPD,KAAKQ,cAAgBC,aAAaC,QAAQV,KAAKC,YAE3CD,KAAKQ,gBACPR,KAAKQ,cAAgBG,KAAKC,MAAMZ,KAAKQ,eAErCR,KAAKa,QAAQC,KAAI,SAACC,GAChB,IAAMC,EAAcT,EAAKC,cAAcS,MAAK,SAACC,GAAa,OAAAA,EAAIC,QAAUJ,EAAOI,SAC/EJ,EAAOZ,OAAOiB,UAAWJ,GAAcA,EAAYb,OAAOiB,aAI9DpB,KAAKqB,mBAGPrB,KAAKsB,uBAGAvB,EAAAM,UAAAkB,aAAA,SAAaR,GAEdf,KAAKwB,gBAAkBxB,KAAKE,SAAWa,EAAOZ,OAAOiB,WAIzDL,EAAOZ,OAAOiB,UAAYL,EAAOZ,OAAOiB,SAEpCpB,KAAKC,YACPD,KAAKqB,kBAGPrB,KAAKG,OAAOsB,KAAK,CACfC,SAAS,EACTX,OAAMA,EACNF,QAASb,KAAKa,UAGhBb,KAAKsB,wBAGAvB,EAAAM,UAAAsB,eAAA,SAAeC,GACpB5B,KAAKa,QAAQC,KAAI,SAACC,GACZA,EAAOZ,OAAO0B,UAChBd,EAAOZ,OAAOiB,UAAW,MAIzBpB,KAAKC,YACPD,KAAKqB,kBAGPrB,KAAKG,OAAOsB,KAAK,CACfC,SAAS,EACTX,OAAQ,KACRF,QAASb,KAAKa,UAGhBb,KAAKsB,sBACLM,EAAqBE,SAGhB/B,EAAAM,UAAA0B,iBAAA,SAAiBhB,GACtB,OAAOA,EAAOZ,OAAOiB,SAAW,GAAK,aAG/BrB,EAAAM,UAAAgB,gBAAA,WACFrB,KAAKC,YACPQ,aAAauB,QAAQhC,KAAKC,WAAYU,KAAKsB,UAAUjC,KAAKa,WAItDd,EAAAM,UAAAiB,oBAAA,WACNtB,KAAKwB,cAAgBxB,KAAKa,QAAQqB,QAAO,SAACC,GAAU,OAAAA,EAAMhC,OAAOiB,UAAYe,EAAMhC,OAAO0B,WAASO,iCA7FtGC,EAAAA,UAASC,KAAA,CAAC,CACTC,SAAU,qBACVC,SAAA,szBAICC,EAAAA,0BAGAA,EAAAA,uBAGAA,EAAAA,sBAGAC,EAAAA,gBCRH,iCALCC,EAAAA,SAAQL,KAAA,CAAC,CACRM,aAAc,CAAC7C,GACf8C,QAAS,CAACC,EAAAA,aAAcC,EAAAA,mBACxBC,QAAS,CAACjD","sourcesContent":["import { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { NgbDropdown } from '@ng-bootstrap/ng-bootstrap';\nimport { PbdsColumnToggle } from './column-toggle.interfaces';\n\n@Component({\n  selector: 'pbds-column-toggle',\n  templateUrl: './column-toggle.component.html',\n  styleUrls: []\n})\nexport class PbdsColumnToggleComponent {\n  @Input()\n  public columns: any[];\n\n  @Input()\n  public storagekey: string | false = false;\n\n  @Input()\n  public minimum: number = 1;\n\n  @Output()\n  public toggle: EventEmitter<PbdsColumnToggle> = new EventEmitter();\n\n  public columnStorage: any;\n  private totalSelected: number;\n\n  public ngOnInit() {\n    if (this.storagekey) {\n      this.columnStorage = localStorage.getItem(this.storagekey);\n\n      if (this.columnStorage) {\n        this.columnStorage = JSON.parse(this.columnStorage);\n\n        this.columns.map((column) => {\n          const savedColumn = this.columnStorage.find((obj: any) => obj.field === column.field);\n          column.toggle.selected = savedColumn ? savedColumn.toggle.selected : true;\n        });\n      }\n\n      this.setLocalStorage();\n    }\n\n    this.updateTotalSelected();\n  }\n\n  public toggleColumn(column: any) {\n    // prevent unchecking all columns\n    if (this.totalSelected === this.minimum && column.toggle.selected) {\n      return;\n    }\n\n    column.toggle.selected = !column.toggle.selected;\n\n    if (this.storagekey) {\n      this.setLocalStorage();\n    }\n\n    this.toggle.emit({\n      showAll: false,\n      column,\n      columns: this.columns\n    });\n\n    this.updateTotalSelected();\n  }\n\n  public showAllColumns(columnToggleDropdown: NgbDropdown) {\n    this.columns.map((column) => {\n      if (column.toggle.visible) {\n        column.toggle.selected = true;\n      }\n    });\n\n    if (this.storagekey) {\n      this.setLocalStorage();\n    }\n\n    this.toggle.emit({\n      showAll: true,\n      column: null,\n      columns: this.columns\n    });\n\n    this.updateTotalSelected();\n    columnToggleDropdown.close();\n  }\n\n  public showSelectedIcon(column: any) {\n    return column.toggle.selected ? '' : 'invisible';\n  }\n\n  private setLocalStorage() {\n    if (this.storagekey) {\n      localStorage.setItem(this.storagekey, JSON.stringify(this.columns));\n    }\n  }\n\n  private updateTotalSelected() {\n    this.totalSelected = this.columns.filter((value) => value.toggle.selected && value.toggle.visible).length;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { NgbDropdownModule } from '@ng-bootstrap/ng-bootstrap';\nimport { PbdsColumnToggleComponent } from './column-toggle.component';\n\n@NgModule({\n  declarations: [PbdsColumnToggleComponent],\n  imports: [CommonModule, NgbDropdownModule],\n  exports: [PbdsColumnToggleComponent]\n})\nexport class PbdsColumnToggleModule {}\n"]}