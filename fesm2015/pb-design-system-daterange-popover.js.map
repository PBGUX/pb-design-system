{"version":3,"file":"pb-design-system-daterange-popover.js","sources":["../../../projects/pb-design-system/daterange-popover/daterange-popover.service.ts","../../../projects/pb-design-system/daterange-popover/daterange-popover.component.ts","../../../projects/pb-design-system/daterange-popover/daterange-popover.module.ts","../../../projects/pb-design-system/daterange-popover/pb-design-system-daterange-popover.ts"],"sourcesContent":["import { Injectable, Inject, LOCALE_ID } from '@angular/core';\nimport { registerLocaleData } from '@angular/common';\n\nimport { PbdsDaterangeLocale } from './daterange-popover.interfaces';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class PbdsDaterangeService {\n  private locale = this.localeId.toLowerCase();\n\n  constructor(@Inject(LOCALE_ID) private localeId: string) {}\n\n  setLocale(locale: PbdsDaterangeLocale) {\n    this.locale = `${locale.language}-${locale.country}`.toLowerCase();\n\n    // set the angular LOCALE_ID dynamically for ng-bootstrap datepicker\n    registerLocaleData(locale.locale, this.locale);\n  }\n\n  getCurrentLocale() {\n    return this.locale;\n  }\n}\n","import {\n  Component,\n  Injectable,\n  OnInit,\n  ViewChild,\n  Input,\n  Output,\n  EventEmitter,\n  OnChanges,\n  SimpleChanges,\n  ChangeDetectionStrategy\n} from '@angular/core';\n\nimport {\n  getLocaleDayNames,\n  getLocaleMonthNames,\n  getLocaleFirstDayOfWeek,\n  FormStyle,\n  TranslationWidth,\n  getLocaleDateFormat,\n  FormatWidth,\n  formatDate\n} from '@angular/common';\n\nimport {\n  NgbPopover,\n  NgbDate,\n  NgbCalendar,\n  NgbDatepickerI18n,\n  NgbDateStruct\n} from '@ng-bootstrap/ng-bootstrap';\n\nimport {\n  PbdsDaterangePreset,\n  PbdsDaterangePresetValue,\n  PbdsDaterangeFilter,\n  PbdsDaterangeChange,\n  PbdsDaterangePlacement\n} from './daterange-popover.interfaces';\nimport { PbdsDaterangeService } from './daterange-popover.service';\n\n// Define custom service providing the months and weekdays translations\n@Injectable()\nexport class CustomDatepickerI18n extends NgbDatepickerI18n {\n  constructor(public daterangeService: PbdsDaterangeService) {\n    super();\n  }\n\n  getWeekdayShortName(weekday: number): string {\n    // for ng-bootstrap, sunday number of 7 converted to 0\n    weekday = weekday === 7 ? 0 : weekday;\n\n    // console.log(\n    //   'weekday: ',\n    //   this.daterangeService.getCurrentLocale(),\n    //   weekday,\n    //   getLocaleDayNames(this.daterangeService.getCurrentLocale(), FormStyle.Standalone, TranslationWidth.Abbreviated)[weekday]\n    // );\n\n    return getLocaleDayNames(\n      this.daterangeService.getCurrentLocale(),\n      FormStyle.Standalone,\n      TranslationWidth.Abbreviated\n    )[weekday];\n  }\n\n  getMonthShortName(month: number): string {\n    return getLocaleMonthNames(this.daterangeService.getCurrentLocale(), FormStyle.Standalone, TranslationWidth.Wide)[\n      month - 1\n    ];\n  }\n\n  getMonthFullName(month: number): string {\n    return getLocaleMonthNames(this.daterangeService.getCurrentLocale(), FormStyle.Standalone, TranslationWidth.Wide)[\n      month - 1\n    ];\n  }\n\n  getDayAriaLabel(date: NgbDateStruct): string {\n    return `${date.day}-${date.month}-${date.year}`;\n  }\n}\n\n@Component({\n  selector: 'pbds-daterange-popover',\n  templateUrl: './daterange-popover.component.html',\n  providers: [{ provide: NgbDatepickerI18n, useClass: CustomDatepickerI18n }],\n  styles: [],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class PbdsDaterangePopoverComponent implements OnInit, OnChanges {\n  @ViewChild('datepickerPopup', { static: false }) private datepickerPopup: NgbPopover;\n\n  @Input()\n  presets: Array<PbdsDaterangePreset> = [\n    {\n      label: 'All Dates',\n      value: null\n    },\n    {\n      label: 'Last 7 Days',\n      value: 7\n    },\n    {\n      label: 'Last 30 Days',\n      value: 30\n    },\n    {\n      label: 'Previous Month',\n      value: 'PREVIOUS_MONTH'\n    },\n    {\n      label: 'Year to Date',\n      value: 'YEAR_TO_DATE'\n    }\n  ];\n\n  @Input()\n  presetSelected: PbdsDaterangePresetValue = null;\n\n  @Input()\n  filters: Array<PbdsDaterangeFilter>;\n\n  @Input()\n  filterSelected = 0;\n\n  @Input()\n  showCustomPreset = true;\n\n  @Input()\n  applyText = 'Apply';\n\n  @Input()\n  cancelText = 'Cancel';\n\n  @Input()\n  container: null | 'body' = 'body';\n\n  @Input()\n  customRangeText = 'Custom Range';\n\n  @Input()\n  displayMonths = 2;\n\n  @Input()\n  displayInput = true;\n\n  @Input()\n  minDate: NgbDate = this.calendar.getPrev(this.calendar.getToday(), 'y');\n\n  @Input()\n  maxDate: NgbDate = this.calendar.getToday();\n\n  @Input()\n  placement: PbdsDaterangePlacement = 'bottom-right auto';\n\n  @Input()\n  fromDate: NgbDate | null = null;\n\n  @Input()\n  toDate: NgbDate | null = null;\n\n  @Input()\n  inputFormat = '{fromDate} to {toDate}';\n\n  @Input()\n  ariaLabel = 'Open date picker';\n\n  @Input()\n  ariaLabelSelected = 'Open date picker, selected range is {selectedRange}'\n\n  @Output()\n  dateChange = new EventEmitter<PbdsDaterangeChange>();\n\n  @Output()\n  cancel = new EventEmitter<any>();\n\n  firstDayOfWeek = getLocaleFirstDayOfWeek(this.daterangeService.getCurrentLocale());\n\n  hoveredDate: NgbDate;\n\n  dateRange = '';\n  isDatepickerVisible = false;\n  selectedFilter;\n  startDate: NgbDate;\n  formattedDate;\n\n  constructor(private calendar: NgbCalendar, private daterangeService: PbdsDaterangeService) {\n  }\n\n  ngOnInit() {\n    // china should start on a Monday, Angular locale returns incorrect 0\n    this.firstDayOfWeek =\n      this.daterangeService.getCurrentLocale() === 'zh-cn' ? this.firstDayOfWeek + 1 : this.firstDayOfWeek;\n\n    if (this.presetSelected === 'CUSTOM') {\n      this.showDatepicker();\n    }\n\n    if (this.presets) {\n      if (!this.filters && this.presetSelected) {\n        this.presetClick(\n          this.presets.find((p, index) => {\n            return index === this.presetSelected;\n          })\n        );\n      } else if (this.presetSelected) {\n        this.presetSelect({ value: this.presetSelected });\n        this.onApply(false);\n      }\n    }\n\n    this.setInputLabel();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.filters && this.filters) {\n      this.selectedFilter = this.filters[this.filterSelected];\n    }\n\n    if (changes.presets) {\n      if (!this.filters && this.presetSelected) {\n        this.presetClick(\n          this.presets.find((p, index) => {\n            return index === this.presetSelected;\n          })\n        );\n      } else if (this.presetSelected) {\n        this.presetSelect({ value: this.presetSelected });\n        this.onApply();\n      }\n    }\n\n    // if (changes.toText && changes.toText.firstChange === false) {\n    //   this.setInputLabel();\n    // }\n\n    this.setInputLabel();\n  }\n\n  onApply(shouldEmit = true) {\n\n    // if only a CUSTOM start date is selected, set the end date to the start date (i.e select a single day)\n    if (!this.toDate) {\n      this.toDate = this.fromDate;\n    }\n\n    this.setInputLabel();\n\n    if (shouldEmit) {\n      this.dateChange.emit({\n        fromDate: this.fromDate,\n        toDate: this.toDate,\n        formattedDate: this.formattedDate,\n        filter: this.filters && this.filters.length > 0 ? this.selectedFilter.field : null,\n        value: this.presetSelected\n      });\n\n      this.datepickerPopup?.close();\n\n      this.ariaLabel = this.ariaLabelFormat();\n\n    }\n  }\n\n  onCancel() {\n    this.datepickerPopup.close();\n\n    this.cancel.emit();\n  }\n\n  onDateSelection(date: NgbDate) {\n    if (!this.fromDate && !this.toDate) {\n      this.fromDate = date;\n    } else if (this.fromDate && !this.toDate && date.after(this.fromDate)) {\n      this.toDate = date;\n    } else {\n      this.toDate = null;\n      this.fromDate = date;\n    }\n\n    // this.presetSelected = null;\n  }\n\n  presetSelect = ($event: Partial<PbdsDaterangePreset>) => {\n    if ($event.value === 'CUSTOM') {\n      this.presetSelected = 'CUSTOM';\n      return false;\n    }\n    this.setDateProperties($event.value);\n    this.isDatepickerVisible = false;\n  };\n\n  presetClick(preset: PbdsDaterangePreset) {\n    if (preset) {\n      if (preset.value === 'CUSTOM') {\n        return false;\n      }\n      this.setDateProperties(preset.value);\n      this.isDatepickerVisible = false;\n      this.onApply();\n    }\n  }\n\n  private getFormattedDate(date: NgbDate) {\n    if (date) {\n      const locale = this.daterangeService.getCurrentLocale();\n      const dateFormat = getLocaleDateFormat(locale, FormatWidth.Short);\n      const formattedDate = formatDate(`${date.month}/${date.day}/${date.year}`, dateFormat, locale);\n      return formattedDate;\n    }\n  }\n\n  isHovered = (date: NgbDate) =>\n    this.fromDate && !this.toDate && this.hoveredDate && date.after(this.fromDate) && date.before(this.hoveredDate);\n\n  isInside = (date: NgbDate) => date.after(this.fromDate) && date.before(this.toDate);\n\n  isRange = (date: NgbDate) =>\n    date.equals(this.fromDate) || date.equals(this.toDate) || this.isInside(date) || this.isHovered(date);\n\n  showDatepicker() {\n    this.isDatepickerVisible = true;\n    this.presetSelect({ value: 'CUSTOM' });\n  }\n\n  onFilterChange(filter, index) {\n    this.selectedFilter = this.filters[index];\n  }\n\n  setPreset(value: PbdsDaterangePresetValue) {\n    this.presetSelected = value;\n    this.presetSelect({ value: this.presetSelected });\n    this.onApply();\n  }\n\n  setFilter(index: number) {\n    if (this.filters !== undefined) {\n      this.selectedFilter = this.filters[index];\n    }\n  }\n\n  setDateRange(value) {\n    this.fromDate = new NgbDate(value.fromDate.year, value.fromDate.month, value.fromDate.day);\n    this.toDate = new NgbDate(value.toDate.year, value.toDate.month, value.toDate.day);\n    this.isDatepickerVisible = value.value === 'CUSTOM';\n    this.presetSelected = value.value;\n\n    if (this.filters) {\n      this.filterSelected = this.filters.findIndex((f) => f.field === value.filter);\n      this.selectedFilter = this.filters[this.filterSelected];\n    }\n\n    this.onApply();\n  }\n\n  private setInputLabel() {\n    if (this.presets) {\n      const selected = this.presets.find((p) => p.value === this.presetSelected);\n\n      if (selected) {\n        if (this.fromDate === null || this.toDate === null) {\n          this.dateRange = selected.label;\n        } else if (this.presetSelected === null || (this.presetSelected !== null && this.presetSelected !== 'CUSTOM')) {\n          this.dateRange = selected.label;\n        } else {\n          this.dateRange = this.dateFormat();\n        }\n      } else if (this.presetSelected === 'CUSTOM' && this.fromDate && this.toDate) {\n        this.dateRange = this.dateFormat();\n      }\n\n      if (this.dateRange !== '') {\n        this.formattedDate = this.isDatepickerVisible ? this.dateFormat() : this.dateRange;\n        this.ariaLabel = this.ariaLabelFormat();\n      }\n    }\n  }\n\n  private dateFormat() {\n    return this.inputFormat\n      .replace('{fromDate}', this.getFormattedDate(this.fromDate))\n      .replace('{toDate}', this.getFormattedDate(this.toDate));\n  }\n\n  private ariaLabelFormat() {\n    return this.ariaLabelSelected.replace('{selectedRange}', this.formattedDate)\n  }\n\n  private getDaysInMonth(year: number, month: number) {\n    return new Date(year, month, 0).getDate();\n  }\n\n  private getFromAndToDates(value: PbdsDaterangePresetValue): { from: NgbDateStruct; to: NgbDateStruct } {\n    const now = new Date();\n    const currentYear = now.getFullYear();\n    const currentMonth = now.getMonth();\n    const currentDay = now.getDate();\n    switch (value) {\n      case 'PREVIOUS_MONTH':\n        const year = currentMonth > 0 ? currentYear : currentYear - 1;\n        const month = currentMonth > 0 ? currentMonth : 12;\n        const day = 1;\n        const lastDay = this.getDaysInMonth(year, month);\n        return {\n          from: { year, month, day },\n          to: { year, month, day: lastDay }\n        };\n      case 'YEAR_TO_DATE':\n        return {\n          from: { year: currentYear, month: 1, day: 1 },\n          to: { year: currentYear, month: currentMonth + 1, day: currentDay }\n        };\n      default:\n        return { from: null, to: null };\n    }\n  }\n\n  private setDateProperties(value: PbdsDaterangePresetValue) {\n    if (value === 'PREVIOUS_MONTH' || value === 'YEAR_TO_DATE') {\n      const { from, to } = this.getFromAndToDates(value);\n      this.fromDate = new NgbDate(from.year, from.month, from.day);\n      this.toDate = new NgbDate(to.year, to.month, to.day);\n      this.presetSelected = value;\n      this.startDate = this.fromDate;\n    } else if (value) {\n      this.toDate = this.calendar.getToday();\n      this.fromDate = this.calendar.getPrev(this.toDate, 'd', Number(value));\n      this.presetSelected = value;\n      this.startDate = this.fromDate;\n    } else {\n      this.fromDate = null;\n      this.toDate = null;\n      this.presetSelected = null;\n      this.startDate = null;\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { NgbDatepickerModule, NgbPopoverModule, NgbDropdownModule } from '@ng-bootstrap/ng-bootstrap';\n\nimport { MatRadioModule } from '@angular/material/radio';\nimport { A11yModule } from '@angular/cdk/a11y';\n\nimport { PbdsDaterangePopoverComponent } from './daterange-popover.component';\n\n@NgModule({\n  declarations: [PbdsDaterangePopoverComponent],\n  imports: [\n    CommonModule,\n    FormsModule,\n    A11yModule,\n    MatRadioModule,\n    NgbDatepickerModule,\n    NgbPopoverModule,\n    NgbDropdownModule\n  ],\n  exports: [PbdsDaterangePopoverComponent]\n})\nexport class PbdsDaterangePopoverModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}